<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2026-01-26T18:20:59+01:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Oumi’s Blog</title><subtitle>Thoughtful reflections on software development, written by a developer for developers.
</subtitle><author><name>Oumaima Zerouali</name><email>oumaima.zerouali@gmail.com</email></author><entry xml:lang="en"><title type="html">The Training I Didn’t Understand (Until I Did)</title><link href="http://localhost:4000/2026/01/26/craftsmanship/" rel="alternate" type="text/html" title="The Training I Didn’t Understand (Until I Did)" /><published>2026-01-26T14:00:00+01:00</published><updated>2026-01-26T14:00:00+01:00</updated><id>http://localhost:4000/2026/01/26/craftsmanship</id><content type="html" xml:base="http://localhost:4000/2026/01/26/craftsmanship/"><![CDATA[<p>Three years ago, on my very first weeks as a developer, I sat in a room listening to Maarten and Bjorn talk about software craftsmanship.</p>

<p>Clean Code. SOLID. TDD. Feedback loops. Katas. Ethics. Professionalism.</p>

<p>It sounded impressive. It also sounded like… noise.</p>

<p>I had just left school. I had barely written tests. I was still proud when my code simply compiled. And here someone was explaining how software development was an <em>ethical profession</em> and why naming was one of the hardest problems in computer science.</p>

<p>I remember leaving that training thinking:</p>

<blockquote>
  <p>“This is interesting… but I honestly have no idea what just happened.”</p>
</blockquote>

<p>A lot went over my head.</p>

<p>And if I’m being completely honest, part of that training didn’t just go over my head, it completely overwhelmed me.</p>

<p>We were doing strict mob programming.</p>

<p>For the first time in my life, I had to program in front of a group of experienced developers, with all the attention on me. My hands were shaking, my mind went blank, and I was no longer thinking about design or clean code.</p>

<p>I was thinking:</p>

<p><em>What if they see I’m not good enough?</em>
<em>What if they fire me?</em>
<em>What if I make a mistake and everyone judges me?</em></p>

<p>At that point, I wasn’t learning craftsmanship.</p>

<p>I was just trying not to panic.</p>

<p>I was so focused on not embarrassing myself that I couldn’t absorb the actual lessons. The concepts flew past me while I was busy managing my anxiety. Looking back, I realize how common this experience is for junior developers. That fear of being “found out” can completely block learning.</p>

<h2 id="fast-forward-three-years">Fast forward three years</h2>

<p>Last week, I followed (almost) the same training again. Same trainer. Same themes. Same slides in some places.</p>

<p>But this time, something very different happened.</p>

<p>Instead of confusion, I kept thinking:</p>

<blockquote>
  <p>“Oh… so <em>that’s</em> what they meant back then.”</p>
</blockquote>

<p>And again:</p>

<blockquote>
  <p>“Wait, this explains half the problems I’ve been fighting in my projects.”</p>
</blockquote>

<p>The training had not changed much. I had.</p>

<p>I no longer care about mob or pair programming, in fact, I now see it as just another tool for collaboration, not something to fear. I am getting more confident giving my ideas, even when they might be wrong. And I am not afraid of being wrong anymore, because I’ve learned that we are all constantly learning, even the senior developers I was so intimidated by three years ago.</p>

<p>That fear from my first training? Gone.</p>

<p>What replaced it was curiosity. Instead of worrying about judgment, I was genuinely interested in the problems we were solving. I asked questions. I challenged ideas. I contributed. For me the difference was night and day.</p>

<h2 id="concrete-lessons-from-the-craftsmanship-training">Concrete lessons from the Craftsmanship training</h2>

<p>Maarten’s training reminded me of <em>how much there is to practice, even in simple exercises</em>. These katas aren’t just coding puzzles, they’re safe spaces to experiment with principles that are risky to try for the first time in production code.</p>

<h3 id="the-bowling-kata-when-confusion-leads-to-learning">The Bowling Kata: When confusion leads to learning</h3>

<p>Take the Bowling Kata, for example. I struggled to implement the spare. It sounded confusing. What even <em>is</em> a spare in bowling terms? How does the scoring work?</p>

<p>But I did write my first test… then my second. I googled the rules, tried it with an online bowling simulator, experimented with different approaches.</p>

<p>Here’s what I learned: even when we don’t fully understand something, it’s important to think before implementing. To really grasp the problem domain before jumping to a solution.</p>

<p>In real life, we often rush to implement without fully grasping the problem. A ticket comes in, we glance at the requirements, and we start coding. This kata reminded me why that’s risky. The time spent understanding the problem, really understanding it, saves far more time than it costs.</p>

<h3 id="other-key-takeaways">Other key takeaways</h3>

<ul>
  <li>
    <p><strong>Testing boundaries:</strong> We spent time discussing edge cases. It’s not enough to test the happy path. What happens at zero? What happens at the maximum? What happens when inputs are unexpected? Always think about boundaries, not just the middle.</p>
  </li>
  <li>
    <p><strong>SOLID refresher:</strong> I thought I knew SOLID. But seeing these principles applied concretely, in real code, during the katas made them stick again. It’s one thing to memorize that the “S” stands for Single Responsibility. It’s another to see a class violating it and feel the pain it causes when trying to test it.</p>
  </li>
  <li>
    <p><strong>Pull Requests vs. Boy Scout Rule:</strong> This discussion was particularly interesting. Maarten says PRs/MRs should always do one thing, one feature, one bug fix, one clear change. But the Boy Scout Rule says: leave the code cleaner than you found it. So what happens when you’re implementing a feature and you stumble on code that desperately needs refactoring? Do you do it in the same PR, or create a new one?</p>
  </li>
</ul>

<p>There’s no perfect answer. Context matters. Sometimes the refactoring is essential to your change. Sometimes it’s a distraction. But the discussion itself is invaluable, it makes you think about the tradeoffs, about code review burden, about git history, about how changes are communicated to your team.</p>

<h2 id="why-it-didnt-work-the-first-time">Why it didn’t work the first time</h2>

<p>When you are a junior developer, you simply don’t have the mental hooks yet.</p>

<p>You haven’t:</p>

<ul>
  <li>Refactored a 10-year-old codebase where every change feels like defusing a bomb.</li>
  <li>Fought with flaky tests that pass locally but fail in CI, wasting hours of your time.</li>
  <li>Been scared to change a single line because you know, deep down, that <em>everything might break</em>.</li>
  <li>Seen how one bad design decision, made in haste, maybe even by you slowly poisons an entire system over months or years.</li>
</ul>

<p>So when someone tells you:</p>

<ul>
  <li>“Test behavior, not implementation”</li>
  <li>“Good naming is more important than clever code”</li>
  <li>“Exceptions are part of your domain”</li>
  <li>“Craftsmanship is about responsibility”</li>
</ul>

<p>…your brain has nowhere to attach those ideas.</p>

<p>They remain abstract. The words sound wise, inspirational even, but they don’t stick. You nod along, maybe take some notes, but there’s no real understanding. How could there be? You haven’t felt the pain these principles are designed to prevent.</p>

<p>At that stage, you mostly care about:</p>

<ul>
  <li>Making it work just get the green checkmark</li>
  <li>Finishing the ticket so you can move to the next one</li>
  <li>Not breaking the build and getting a message from the team</li>
  <li>Proving you can deliver something, anything</li>
</ul>

<p>And that is perfectly normal. You have to walk before you can run. You have to make mistakes before you can learn from them.</p>

<h2 id="why-it-suddenly-made-sense-now">Why it suddenly made sense now</h2>

<p>Three years later, I have scars.</p>

<p>I have seen:</p>

<ul>
  <li>Tests that tested the wrong thing mocking so much that the test passed even when the actual feature was broken.</li>
  <li>Code that nobody dared to touch because the original developer left and there were no tests, no documentation, just cryptic variable names and mysterious business logic.</li>
  <li>Classes with five responsibilities, making them impossible to test in isolation and painful to modify.</li>
  <li>Methods that needed comments because the names were meaningless: <code class="language-plaintext highlighter-rouge">processData()</code>, <code class="language-plaintext highlighter-rouge">handleStuff()</code>, <code class="language-plaintext highlighter-rouge">doTheThing()</code>, giving you no clue what they actually did.</li>
  <li>“Quick fixes” that were supposed to be temporary but lived in production for years because no one wanted to be the one to refactor them.</li>
</ul>

<p>So when Maarten now talks about:</p>

<ul>
  <li><strong>Feedback loops:</strong> Getting fast confirmation that your code works, through tests, through small iterations, through quick deployments.</li>
  <li><strong>Boundaries around infrastructure:</strong> Keeping your business logic separate from databases, APIs, frameworks so you can test without spinning up the entire world.</li>
  <li><strong>Single Responsibility:</strong> Each class, each method, doing one thing well, so when change comes (and it always does), you know exactly where to look.</li>
  <li><strong>Craftsmanship as a mindset, not a checklist:</strong> This isn’t about following rules blindly. It’s about caring. About taking pride in your work. About leaving things better than you found them.</li>
</ul>

<p>…I wasn’t hearing theory anymore.</p>

<p>I was hearing explanations for my own past mistakes. Solutions to problems I had personally struggled with. War stories I could relate to because I had lived through similar battles.</p>

<p>That moment, when a concept suddenly connects to your lived experience, is magical.</p>

<p>That’s when learning really starts. Not when you memorize the definition, but when you <em>feel</em> why it matters.</p>

<h2 id="why-im-grateful-i-had-this-training-twice">Why I’m grateful I had this training twice</h2>

<p>Looking back, I’m actually very grateful I had this training twice.</p>

<p>Even though I didn’t understand much the first time, the ideas stayed somewhere in the back of my mind. Like seeds planted in soil, waiting for the right conditions to grow.</p>

<p>They influenced:</p>

<ul>
  <li>How I look at code, I notice code smells faster now</li>
  <li>How I think about testing, not as a chore, but as a design tool</li>
  <li>How seriously I take my responsibility as an engineer, the code I write today becomes someone else’s legacy tomorrow</li>
</ul>

<p>This second time, the training did not just teach me new things.</p>

<p>It helped me reinterpret my entire first years as a developer. Suddenly, all those frustrating experiences made sense. They weren’t just random problems, they were predictable consequences of violating these principles.</p>

<p>The messy codebase? Lack of Single Responsibility and poor boundaries.</p>

<p>The flaky tests? Testing implementation instead of behavior.</p>

<p>The fear of changing code? No safety net of tests, poor naming making intent unclear.</p>

<p>Everything connected. And that is probably the real value of craftsmanship education: Not giving you rules to follow blindly.
But slowly shaping how you think about your work. Building a mental model that helps you make better decisions, even in new situations you’ve never encountered before.</p>

<h2 id="whats-next">What’s next</h2>

<p>This was only part 1 of the training. Part 2 is coming, and honestly? I can’t wait.</p>

<p>If part 1 gave me this many insights, this many “aha!” moments where past experiences suddenly made sense, I’m excited to see what part 2 will reveal. What other patterns will I recognize? What other mistakes will I understand?</p>

<p>The beauty of this journey is that there’s always more to learn. Always another layer to uncover. Always another way to improve.</p>

<p>Three years ago, I left that training room confused and overwhelmed.</p>

<p>Today, I leave it energized and ready to dig deeper.</p>

<h2 id="thank-you">Thank you</h2>

<p>Thank you, Maarten, for the training and for suggesting I take it again. You were right: timing matters, and sometimes the best gift is the same lesson at the right moment.</p>]]></content><author><name>Oumaima Zerouali</name><email>oumaima.zerouali@gmail.com</email></author><category term="craftsmanship" /><category term="training" /><category term="learning" /><category term="developer" /><category term="growth" /><summary type="html"><![CDATA[Three years ago, on my very first weeks as a developer, I sat in a room listening to Maarten and Bjorn talk about software craftsmanship.]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/img/software_craftsmanship.jpg" /><media:content medium="image" url="http://localhost:4000/assets/img/software_craftsmanship.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="en"><title type="html">Designing JCast Merch (Without Any Design Experience)</title><link href="http://localhost:4000/2026/01/23/jcast-merch/" rel="alternate" type="text/html" title="Designing JCast Merch (Without Any Design Experience)" /><published>2026-01-23T12:00:00+01:00</published><updated>2026-01-23T12:00:00+01:00</updated><id>http://localhost:4000/2026/01/23/jcast-merch</id><content type="html" xml:base="http://localhost:4000/2026/01/23/jcast-merch/"><![CDATA[<blockquote>
  <p>“I’m ready, I’m ready… to make something awesome!” – SpongeBob SquarePants</p>
</blockquote>

<p>When we started <a href="https://jcast.dev">JCast</a>, the goal was simple: record a podcast, talk about tech, and see where it would end up.</p>

<p>Along the way, it became… more serious.</p>

<p>We upgraded our equipment.
We kept recording consistently.
The enthusiasm was still there, episode after episode.</p>

<p>At some point, it started to feel less like “a fun side project” and more like… a real podcast.</p>

<p>And then, on a completely random day, I had a thought:</p>

<p><em>This podcast needs merch.</em></p>

<p>Not for listeners. Not for ads. Just for us.
For Viktor, Maarten, and myself. Something simple. Something fun. A small symbol that said: “Yes, this is real now.”</p>

<h3 id="from-java-to-pinterest">From Java to Pinterest</h3>

<p>There was only one small problem.</p>

<p>I had never designed anything in my life. Let alone merch.
So I did what every responsible developer does when entering unknown territory:</p>

<p>I opened Pinterest.</p>

<p>I scrolled through endless T-shirt designs.
Podcast logos. Minimal typography. Quotes. Layouts.</p>

<p>Then I opened Canva and started playing with fonts and tiny design experiments.</p>

<p>And… nothing worked.</p>

<p>Everything looked either:</p>

<ul>
  <li>Too generic</li>
  <li>Too busy</li>
  <li>Too cringe</li>
  <li>Or simply not “JCast”</li>
</ul>

<p>I had something in my head, but I couldn’t translate it onto the screen.
So I took the only logical next step.</p>

<p>I opened Figma.</p>

<h3 id="designing-a-t-shirt-like-it-was-a-poster">Designing a T-shirt like it was a poster</h3>

<p>Instead of thinking in fabric, I started thinking in something I <em>did</em> know: layout.
I made A4 designs.
As if I were designing posters, not T-shirts.</p>

<p>I placed the logo.
Played with whitespace.
Tried different font combinations.</p>

<p>Slowly, something started to take shape.</p>

<p>And the surprising part?</p>

<p>I loved it.</p>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 2fr)); gap: 2rem; margin: 2rem 0; padding: 2rem; background: #eae6df; border-radius: 8px;">
  <div>
    <img src="/assets/img/merch_draft_1.png" alt="First T-shirt design variant" style="max-width: 100%; height: auto; border-radius: 8px;" />
    <p style="text-align: center; font-size: 0.9rem; color: #666; margin-top: 0.5rem;">Variant 1: Minimal logo design</p>
  </div>
  <div>
    <img src="/assets/img/full_color.png" alt="Final printed JCast T-shirt with logo" style="max-width: 100%; height: auto; border-radius: 8px;" />
    <p style="text-align: center; font-size: 0.9rem; color: #666; margin-top: 0.5rem;">Variant 2: Testing color combinations</p>
  </div>
  <div>
    <img src="/assets/img/merch_draft_2.png" alt="Second T-shirt design variant" style="max-width: 100%; height: auto; border-radius: 8px;" />
    <p style="text-align: center; font-size: 0.9rem; color: #666; margin-top: 0.5rem;">Variant 3: Typography-focused</p>
  </div>
</div>

<p>This looked nothing like programming.</p>

<p>No compiler errors.
No stack traces.
No tests failing because of a missing semicolon.</p>

<p>Just pure experimentation.</p>

<p>Move something slightly to the left.
Adjust a font weight.
Delete half of it and start over.</p>

<p>It was calm. Creative. Almost therapeutic.</p>

<h3 id="the-first-print">The first print</h3>

<p>Eventually, I had something I was genuinely happy with.</p>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin: 2rem 0; padding: 2rem; background: #eae6df; border-radius: 8px;">
  <div style="text-align: center;">
    <img src="/assets/img/first_variant.svg" alt="First final T-shirt print design" style="max-width: 100%; height: auto;" />
  </div>
  <div style="text-align: center;">
    <img src="/assets/img/second_variant.svg" alt="Second final T-shirt print design" style="max-width: 100%; height: auto;" />
  </div>
</div>

<p>So I had one printed.</p>

<p>Just <em>one</em>.</p>

<p>I brought it to the guys and showed it to them. They liked it.</p>

<p>And then something unexpected happened. Other colleagues heard about it.</p>

<p>“Wait… you made JCast T-shirts?”
“Can I get one too?”
“Do you have it in another color?”</p>

<p>Suddenly, this thing that was only meant for the three hosts…
became something other people wanted too.</p>

<p>We made more.
Different colors.
Different sizes.</p>

<p>And people actually started wearing them.</p>

<h3 id="the-unexpected-proud-moment">The unexpected proud moment</h3>

<p>The moment that stuck with me the most was this:</p>

<p>Seeing someone, who isn’t part of the podcast, wearing a T-shirt with a design <em>I</em> made.</p>

<p>Not because they had to.
Not because it was merch.</p>

<p>But simply… because they liked it.</p>

<p>As developers, we often build things that are invisible.
APIs. Services. Backend systems.</p>

<p>This time, I had built something you can literally wear.</p>

<p>And that felt incredibly special.</p>

<p>That small moment also made me reflect on what this project had really taught me.</p>

<p>Creativity, it turns out, is just another form of problem-solving.
Being bad at something again is refreshing.
Constraints, print, colors, layout, help design, just like constraints help architecture.</p>

<p>And sometimes, the most rewarding projects start with a random idea on a random day.</p>

<p><a href="https://jcast.dev">JCast</a> started as a podcast.
Along the way, it became a small community.</p>

<p>And apparently… also a clothing brand.</p>

<figure style="margin: 3rem 0; text-align: center;">
  <img src="/assets/img/overview_figma_file.png" alt="Screenshot of my Figma workspace with multiple T-shirt design variants" style="max-width: 100%; height: auto; border-radius: 8px;" />
  <figcaption style="margin-top: 0.75rem; font-size: 0.9rem; color: #666;">
    A screenshot of my Figma board at the end of the process — full of ideas, variants, and half-finished attempts.
  </figcaption>
</figure>

<hr />

<p><em>Curious about the podcast behind these T-shirts?</em></p>

<p>Feel free to visit <a href="https://jcast.dev">jcast.dev</a> and discover <a href="https://jcast.dev">JCast</a>.</p>]]></content><author><name>Oumaima Zerouali</name><email>oumaima.zerouali@gmail.com</email></author><category term="jcast" /><category term="merch" /><category term="design" /><category term="figma" /><category term="canva" /><category term="podcast" /><summary type="html"><![CDATA[“I’m ready, I’m ready… to make something awesome!” – SpongeBob SquarePants]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/img/logo.png" /><media:content medium="image" url="http://localhost:4000/assets/img/logo.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="nl"><title type="html">JCast-merch ontwerpen (zonder enige designervaring)</title><link href="http://localhost:4000/nl/2026/01/23/jcast-merch/" rel="alternate" type="text/html" title="JCast-merch ontwerpen (zonder enige designervaring)" /><published>2026-01-23T12:00:00+01:00</published><updated>2026-01-23T12:00:00+01:00</updated><id>http://localhost:4000/nl/2026/01/23/jcast-merch</id><content type="html" xml:base="http://localhost:4000/nl/2026/01/23/jcast-merch/"><![CDATA[<blockquote>
  <p>“I’m ready, I’m ready… to make something awesome!” – SpongeBob SquarePants</p>
</blockquote>

<p>Toen we met <a href="https://jcast.dev">JCast</a> begonnen, was het doel simpel: een podcast opnemen, over tech praten en zien waar het zou eindigen.</p>

<p>Onderweg werd het… serieuzer.</p>

<p>We hebben onze apparatuur geüpgraded.<br />
We bleven consequent opnemen.<br />
Het enthousiasme was er nog steeds, aflevering na aflevering.</p>

<p>Op een bepaald moment voelde het minder als “een leuk zijproject” en meer als… een echte podcast.</p>

<p>En toen had ik, op een compleet willekeurige dag, een gedachte:</p>

<p><em>Deze podcast heeft merch nodig.</em></p>

<p>Niet voor luisteraars. Niet voor advertenties. Gewoon voor ons.<br />
Voor Viktor, Maarten en mijzelf. Iets simpels. Iets leuks. Een klein symbool dat zei: “Ja, dit is nu echt.”</p>

<h3 id="van-java-naar-pinterest">Van Java naar Pinterest</h3>

<p>Er was alleen één klein probleem.</p>

<p>Ik had nog nooit in mijn leven iets ontworpen. En al helemaal geen merch.<br />
Dus deed ik wat elke verantwoordelijke developer doet als hij onbekend terrein betreedt:</p>

<p>Ik opende Pinterest.</p>

<p>Ik scrolde door eindeloze T-shirtontwerpen.<br />
Podcastlogo’s. Minimalistische typografie. Quotes. Layouts.</p>

<p>Daarna opende ik Canva en begon te spelen met fonts en kleine designexperimenten.</p>

<p>En… niets werkte.</p>

<p>Alles zag er óf:</p>

<ul>
  <li>Te generiek</li>
  <li>Te druk</li>
  <li>Te cringe</li>
  <li>Of gewoon niet “JCast” uit</li>
</ul>

<p>Ik had iets in mijn hoofd, maar ik kreeg het niet vertaald naar het scherm.<br />
Dus deed ik de enige logische volgende stap.</p>

<p>Ik opende Figma.</p>

<h3 id="een-t-shirt-ontwerpen-alsof-het-een-poster-was">Een T-shirt ontwerpen alsof het een poster was</h3>

<p>In plaats van te denken in stof, begon ik te denken in iets dat ik <em>wel</em> kende: layout.<br />
Ik maakte A4-ontwerpen.<br />
Alsof ik posters ontwierp, geen T-shirts.</p>

<p>Ik plaatste het logo.<br />
Speelde met witruimte.<br />
Probeerde verschillende fontcombinaties.</p>

<p>Langzaam begon er iets vorm te krijgen.</p>

<p>En het verrassende?</p>

<p>Ik vond het geweldig.</p>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 2fr)); gap: 2rem; margin: 2rem 0; padding: 2rem; background: #eae6df; border-radius: 8px;">
  <div>
    <img src="/assets/img/merch_draft_1.png" alt="Eerste T-shirt ontwerp variant" style="max-width: 100%; height: auto; border-radius: 8px;" />
    <p style="text-align: center; font-size: 0.9rem; color: #666; margin-top: 0.5rem;">Variant 1: Minimalistisch logo design</p>
  </div>
  <div>
    <img src="/assets/img/full_color.png" alt="De uiteindelijke gedrukte T-shirt met JCast logo" style="max-width: 100%; height: auto; border-radius: 8px;" />
    <p style="text-align: center; font-size: 0.9rem; color: #666; margin-top: 0.5rem;">Variant 2: Kleurencombo’s testen</p>
  </div>
  <div>
    <img src="/assets/img/merch_draft_2.png" alt="Tweede T-shirt ontwerp variant" style="max-width: 100%; height: auto; border-radius: 8px;" />
    <p style="text-align: center; font-size: 0.9rem; color: #666; margin-top: 0.5rem;">Variant 3: Typography focus</p>
  </div>
</div>

<p>Dit leek totaal niet op programmeren.</p>

<p>Geen compiler errors.<br />
Geen stack traces.<br />
Geen tests die faalden door een ontbrekende puntkomma.</p>

<p>Gewoon puur experimenteren.</p>

<p>Iets een beetje naar links schuiven.<br />
Een fontgewicht aanpassen.<br />
De helft verwijderen en opnieuw beginnen.</p>

<p>Het was rustig. Creatief. Bijna therapeutisch.</p>

<h3 id="de-eerste-print">De eerste print</h3>

<p>Uiteindelijk had ik iets waar ik echt blij mee was.</p>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin: 2rem 0; padding: 2rem; background: #eae6df; border-radius: 8px;">
  <div style="text-align: center;">
    <img src="/assets/img/first_variant.svg" alt="Eerste definitieve T-shirt print design" style="max-width: 100%; height: auto;" />
  </div>
  <div style="text-align: center;">
    <img src="/assets/img/second_variant.svg" alt="Tweede definitieve T-shirt print design" style="max-width: 100%; height: auto;" />
  </div>
</div>

<p>Dus ik liet er eentje drukken.</p>

<p>Gewoon <em>één</em>.</p>

<p>Ik nam hem mee naar de jongens en liet hem zien. Ze vonden het leuk.</p>

<p>En toen gebeurde er iets onverwachts. Andere collega’s hoorden ervan.</p>

<p>“Wacht… jij hebt JCast-T-shirts gemaakt?”<br />
“Kan ik er ook eentje krijgen?”<br />
“Heb je hem ook in een andere kleur?”</p>

<p>Plots werd dit ding, dat alleen voor de drie hosts bedoeld was…<br />
iets wat andere mensen ook wilden.</p>

<p>We maakten er meer.<br />
Andere kleuren.<br />
Andere maten.</p>

<p>En mensen begonnen ze daadwerkelijk te dragen.</p>

<h3 id="het-onverwachte-trotsmoment">Het onverwachte trotsmoment</h3>

<p>Het moment dat me het meest is bijgebleven, is dit:</p>

<p>Iemand zien, die geen deel uitmaakt van de podcast, die een T-shirt draagt met een ontwerp dat <em>ik</em> heb gemaakt.</p>

<p>Niet omdat het moest.<br />
Niet omdat het merch was.</p>

<p>Maar gewoon… omdat ze het mooi vonden.</p>

<p>Als developers bouwen we vaak dingen die onzichtbaar zijn.<br />
API’s. Services. Achtergrondsystemen.</p>

<p>Deze keer had ik iets gemaakt dat je letterlijk kunt dragen.</p>

<p>En dat voelde ongelooflijk speciaal.</p>

<p>Dat kleine moment deed me ook even stilstaan bij wat dit project me eigenlijk had geleerd.</p>

<p>Creativiteit, zo bleek, is gewoon een andere vorm van probleemoplossen.<br />
Weer ergens slecht in zijn is verfrissend.<br />
Beperkingen — print, kleuren, layout — helpen design, net zoals beperkingen architectuur helpen.</p>

<p>En soms beginnen de meest belonende projecten met een willekeurig idee op een willekeurige dag.</p>

<p><a href="https://jcast.dev">JCast</a> begon als een podcast.<br />
Onderweg werd het een kleine community.</p>

<p>En blijkbaar… ook een kledingmerk.</p>

<figure style="margin: 3rem 0; text-align: center;">
  <img src="/assets/img/overview_figma_file.png" alt="Screenshot van mijn Figma werkbestand met verschillende T-shirt ontwerp varianten" style="max-width: 100%; height: auto; border-radius: 8px;" />
  <figcaption style="margin-top: 0.75rem; font-size: 0.9rem; color: #666;">
    Een screenshot van mijn Figma-bord aan het einde van het proces — vol ideeën, varianten en half afgemaakte pogingen.
  </figcaption>
</figure>

<hr />

<p><em>Benieuwd naar de podcast achter deze T-shirts?</em></p>

<p>Neem gerust een kijkje op <a href="https://jcast.dev">jcast.dev</a> en ontdek <a href="https://jcast.dev">JCast</a>.</p>]]></content><author><name>Oumaima Zerouali</name><email>oumaima.zerouali@gmail.com</email></author><category term="jcast" /><category term="merch" /><category term="design" /><category term="figma" /><category term="canva" /><category term="podcast" /><summary type="html"><![CDATA[“I’m ready, I’m ready… to make something awesome!” – SpongeBob SquarePants]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/img/logo.png" /><media:content medium="image" url="http://localhost:4000/assets/img/logo.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="nl"><title type="html">Migratie naar Java 25 en Spring Boot 4: eerlijk, het was chaos</title><link href="http://localhost:4000/nl/2026/01/22/migration-to-java-25/" rel="alternate" type="text/html" title="Migratie naar Java 25 en Spring Boot 4: eerlijk, het was chaos" /><published>2026-01-22T12:00:00+01:00</published><updated>2026-01-22T12:00:00+01:00</updated><id>http://localhost:4000/nl/2026/01/22/migration-to-java-25</id><content type="html" xml:base="http://localhost:4000/nl/2026/01/22/migration-to-java-25/"><![CDATA[<blockquote>
  <p>“I’m ready… to break everything and figure it out later!” – SpongeBob SquarePants</p>
</blockquote>

<p>Iedereen zegt altijd dat upgraden van Spring makkelijk is, toch? Gewoon <strong>OpenRewrite</strong> draaien, een paar kleine dingen fixen en klaar.</p>

<p>Nou… laat me vertellen over onze migratie van <strong>Java 17/21 naar Java 25</strong> en <strong>Spring Boot 3 naar 4.0.1</strong>.</p>

<p>Voor één service kost het nu maximaal één uur om alles te fixen. Niet zo erg. Maar ik heb deze migratie al een paar keer gedaan bij de klant. En ik blijf steeds dezelfde problemen tegenkomen, keer op keer.</p>

<p>Dus ik dacht: laat ik dit opschrijven. Misschien helpt het iemand anders die deze migratie moet doen.</p>

<h2 id="waarom-we-dit-überhaupt-deden">Waarom we dit überhaupt deden</h2>

<p>Onze tech lead wilde naar <strong>Java 25</strong>. Zijn reden? Hij wil altijd de nieuwste versie van alles. En eerlijk, ik was wel enthousiast om eens een migratie mee te maken.</p>

<p>Daarnaast moesten we:</p>

<ul>
  <li>Upgraden naar <strong>Spring Boot 4</strong> en <strong>Spring Framework 7</strong></li>
  <li>De <strong>Jakarta-migratie</strong> volledig afronden</li>
  <li>Oude code opruimen voordat we nieuwe features toevoegen</li>
</ul>

<p>Onze applicaties bevatten allemaal:</p>

<ul>
  <li>REST APIs</li>
  <li>Custom HTTP clients</li>
  <li>JWT security</li>
  <li>File uploads</li>
  <li>Heel veel tests met MockMvc</li>
  <li>Jackson voor JSON overal</li>
</ul>

<h2 id="openrewrite-helpt-maar-is-geen-magie">OpenRewrite: helpt, maar is geen magie</h2>

<p>We begonnen met <strong>OpenRewrite</strong> en de officiële Spring recipes (<a href="https://docs.openrewrite.org/recipes/java">bron</a>).</p>

<p>Wat Rewrite goed deed:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">javax.*</code> → <code class="language-plaintext highlighter-rouge">jakarta.*</code></li>
  <li>Spring imports updaten</li>
  <li>Deprecated APIs fixen</li>
  <li>Config classes aanpassen</li>
  <li><strong>Try-catch syntax vereenvoudigen</strong></li>
  <li><code class="language-plaintext highlighter-rouge">.additionalMessageConverters(new MappingJackson2HttpMessageConverter())</code> → <code class="language-plaintext highlighter-rouge">.additionalMessageConverters(new JacksonJsonHttpMessageConverter())</code></li>
  <li><code class="language-plaintext highlighter-rouge">.format(...)</code> → <code class="language-plaintext highlighter-rouge">.formatted(...)</code></li>
  <li><strong>YAML splitsen per profiel</strong></li>
</ul>

<p><em>Maar… er kwamen ook snel problemen.</em></p>

<h2 id="openrewrite--jdkjre-mismatch">OpenRewrite + JDK/JRE mismatch</h2>

<p>Eerste keer dat ik OpenRewrite draaide op Java 25 crashte het met:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">LinkageError</span><span class="o">:</span> <span class="n">loader</span> <span class="n">constraint</span> <span class="nl">violation:</span> <span class="n">com</span><span class="o">.</span><span class="na">sun</span><span class="o">.</span><span class="na">tools</span><span class="o">.</span><span class="na">javac</span><span class="o">.</span><span class="na">parser</span><span class="o">.</span><span class="na">Tokens</span><span class="n">$Comment$CommentStyle</span>
</code></pre></div></div>

<p>Oorzaak: <strong>JDK en JRE waren niet dezelfde versie</strong>.</p>

<p><strong>Fix:</strong></p>

<ul>
  <li>Check altijd dat JDK en JRE dezelfde versie hebben</li>
  <li>Voor ons: beide op <strong>Java 25</strong> zetten</li>
</ul>

<h2 id="alles-compileert--dan-exploderen-de-tests">“Alles compileert!” … dan exploderen de tests</h2>

<p>Na Rewrite en alle compileerfouten fixen, startten we de tests. En dan? Alles faalde.</p>

<p>Problemen zaten vooral in:</p>

<ul>
  <li>MockMvc tests</li>
  <li>JSON serialization</li>
  <li>HTTP clients</li>
  <li>Jackson config</li>
</ul>

<h2 id="jackson-de-pijn-die-nooit-stopt">Jackson: de pijn die nooit stopt</h2>

<p>Spring Boot 4 verhuist Jackson van:</p>

<p>Oude locatie:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">com</span><span class="o">.</span><span class="na">fasterxml</span><span class="o">.</span><span class="na">jackson</span><span class="o">.*</span>
</code></pre></div></div>

<p>Nieuwe locatie:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tools</span><span class="o">.</span><span class="na">jackson</span><span class="o">.*</span>
</code></pre></div></div>

<p>Problemen die we tegenkwamen:</p>

<ul>
  <li>Mixed imports in tests</li>
  <li>Constants zoals <code class="language-plaintext highlighter-rouge">WRITE_DATES_AS_TIMESTAMPS</code> verdwenen</li>
  <li>ObjectMapper conflicts, vooral in tests met meerdere primary beans</li>
</ul>

<p>Vroeger hadden we:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="nd">@Primary</span>
<span class="nc">ObjectMapper</span> <span class="nf">objectMapper</span><span class="o">(</span><span class="nc">Jackson2ObjectMapperBuilder</span> <span class="n">builder</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">builder</span><span class="o">.</span><span class="na">dateFormat</span><span class="o">(...).</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>In Boot 4:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Jackson2ObjectMapperBuilder</code> is <strong>deprecated</strong></li>
  <li>Boot maakt zijn eigen <strong>primary</strong> <code class="language-plaintext highlighter-rouge">jacksonJsonMapper</code></li>
</ul>

<p>Resultaat:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NoUniqueBeanDefinitionException:
more than one 'primary' bean found: [objectMapper, jacksonJsonMapper]
</code></pre></div></div>

<p><strong>Nieuwe aanpak:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="nc">ObjectMapper</span> <span class="nf">objectMapper</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="n">dateFormat</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleDateFormat</span><span class="o">(</span><span class="s">"dd-MM-yyyy"</span><span class="o">);</span>

    <span class="k">return</span> <span class="nc">JsonMapper</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
            <span class="o">.</span><span class="na">defaultDateFormat</span><span class="o">(</span><span class="n">dateFormat</span><span class="o">)</span>
            <span class="o">.</span><span class="na">findAndAddModules</span><span class="o">()</span>
            <span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Bron:</strong> <a href="https://spring.io/blog/2025/10/07/introducing-jackson-3-support-in-spring">Introducing Jackson 3 support in Spring</a></p>

<h2 id="resttemplate--http-veranderingen">RestTemplate &amp; HTTP veranderingen</h2>

<h3 id="resttemplatebuilder-verplaatst">RestTemplateBuilder verplaatst</h3>

<p>Oude locatie:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">client</span><span class="o">.</span><span class="na">RestTemplateBuilder</span>
</code></pre></div></div>

<p>Nieuwe locatie:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">boot</span><span class="o">.</span><span class="na">restclient</span><span class="o">.</span><span class="na">RestTemplateBuilder</span>
</code></pre></div></div>

<blockquote>
  <p>In productiecode migreer je vaak naar <strong>RestClient</strong>, Spring Boot 4 geeft hier voorkeur aan.</p>
</blockquote>

<h3 id="response-api-veranderd">Response API veranderd</h3>

<p>Oude manier:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span><span class="o">.</span><span class="na">getStatusCodeValue</span><span class="o">()</span>
</code></pre></div></div>

<p>Nieuwe manier:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span><span class="o">.</span><span class="na">getStatusCode</span><span class="o">().</span><span class="na">value</span><span class="o">()</span>
</code></pre></div></div>

<h3 id="headers-vervangen">Headers vervangen</h3>

<p>Oude Apache manier:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Header</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getAllHeaders</span><span class="o">();</span>
</code></pre></div></div>

<p>Nieuwe Spring manier:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">HttpHeaders</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getHeaders</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="timeouts-zijn-nu-builders">Timeouts zijn nu builders</h3>

<p>Oude setters bestaan niet meer. Nieuw:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">HttpComponentsClientHttpRequestFactory</span> <span class="n">requestFactory</span> <span class="o">=</span>
    <span class="nc">ClientHttpRequestFactoryBuilder</span><span class="o">.</span><span class="na">httpComponents</span><span class="o">()</span>
        <span class="o">.</span><span class="na">withDefaultRequestConfigCustomizer</span><span class="o">(</span><span class="n">rc</span> <span class="o">-&gt;</span> <span class="n">rc</span>
            <span class="o">.</span><span class="na">setConnectTimeout</span><span class="o">(</span><span class="nc">Timeout</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span>
            <span class="o">.</span><span class="na">setConnectionRequestTimeout</span><span class="o">(</span><span class="nc">Timeout</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span>
            <span class="o">.</span><span class="na">setResponseTimeout</span><span class="o">(</span><span class="nc">Timeout</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span>
        <span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</code></pre></div></div>

<p><strong>Custom HttpClients</strong> moeten nu via <code class="language-plaintext highlighter-rouge">.withHttpClientCustomizer(...)</code> worden toegevoegd.
<strong>Bron:</strong> <a href="https://docs.spring.io/spring-framework/reference/integration/rest-clients.html#rest-request-factories">Spring Framework 7 HTTP Client</a></p>

<h2 id="apache-httpclient-4--5">Apache HttpClient 4 → 5</h2>

<p>Alles is veranderd:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">org.apache.http.*</code> → <code class="language-plaintext highlighter-rouge">org.apache.hc.*</code></li>
  <li>Timeouts, SSL, connection managers, request builders → volledige rewrite</li>
</ul>

<p><strong>Bron:</strong> <a href="https://hc.apache.org/httpcomponents-client-5.6.x/migration-guide/preparation.html">Apache HttpClient 5 Migration</a></p>

<h2 id="swagger--openapi-na-jakarta">Swagger &amp; OpenAPI na Jakarta</h2>

<p>Na migratie verdwijnen OpenAPI annotaties. Voeg toe:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>io.swagger.core.v3<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>swagger-annotations-jakarta<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>
<p><strong>Bron:</strong> <a href="https://github.com/swagger-api/swagger-core">Swagger</a></p>

<h2 id="spring-security-7-websocket">Spring Security 7 WebSocket</h2>

<p><code class="language-plaintext highlighter-rouge">AbstractSecurityWebSocketMessageBrokerConfigurer</code> is verwijderd. Voor ons werkt deze aanpak:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.messaging.Message</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.authorization.AuthorizationDecision</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.authorization.AuthorizationManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.config.annotation.web.messaging.EnableWebSocketSecurity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.messaging.access.intercept.MessageAuthorizationContext</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.messaging.access.intercept.MessageMatcherDelegatingAuthorizationManager</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="nd">@EnableWebSocketSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebSocketSecurityConfig</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">AuthorizationManager</span><span class="o">&lt;</span><span class="nc">Message</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">messageAuthorizationManager</span><span class="o">(</span>
            <span class="nc">MessageMatcherDelegatingAuthorizationManager</span><span class="o">.</span><span class="na">Builder</span> <span class="n">messages</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">messages</span>
                <span class="o">.</span><span class="na">nullDestMatcher</span><span class="o">().</span><span class="na">permitAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">simpSubscribeDestMatchers</span><span class="o">(</span><span class="s">"/**"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">simpDestMatchers</span><span class="o">(</span><span class="s">"/**"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">anyMessage</span><span class="o">().</span><span class="na">permitAll</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">messages</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">AuthorizationManager</span><span class="o">&lt;</span><span class="nc">MessageAuthorizationContext</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">authorizationManager</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">AuthorizationDecision</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Bron:</strong> <a href="https://newreleases.io/project/github/spring-projects/spring-security/release/7.0.0-M1">Spring Security 7 WebSocket</a>,
<a href="https://github.com/spring-projects/spring-security/pull/17328">Github Thread</a></p>

<h2 id="terugkerende-problemen">Terugkerende problemen</h2>

<p>Tijdens de migratie kwamen de meeste problemen steeds terug, vooral in tests:</p>

<ul>
  <li>Jackson namespace breekt constant</li>
  <li>ObjectMapper conflicts in tests</li>
  <li>HTTP client configuratie moet volledig herschreven worden</li>
  <li>Response handling methoden gewijzigd</li>
  <li>RestTemplate en builders hebben nieuwe imports of zijn vervangen door RestClient</li>
  <li>Tests falen vaak ondanks succesvolle compilatie</li>
</ul>

<p>Daarnaast blijkt dat compiler, serialisatielaag, SSL-configuratie en auto-configuration allemaal tegelijk worden beïnvloed door de upgrade.</p>

<h2 id="wat-ik-zou-aanraden">Wat ik zou aanraden</h2>

<ul>
  <li>Plan extra tijd voor tests</li>
  <li>Verwacht Jackson-problemen en ObjectMapper-conflicten</li>
  <li>Bereid je voor op herschrijven van HTTP client code</li>
  <li>Run je volledige test suite vroeg en vaak</li>
  <li>Gebruik OpenRewrite</li>
</ul>

<p>Persoonlijk ben ik blij dat ik deze migratie zelf mocht doen. Ondanks de frustraties en het vele lezen van documentatie, gaf het me een veel dieper inzicht in hoe Spring Boot en Spring Framework werken en hoe ze de controle over infrastructuur en configuratie hebben.</p>

<p>Wil je meer weten over Spring Boot 4 en Spring Framework 7? Check dan volgende post: <a href="https://www.baeldung.com/spring-boot-4-spring-framework-7">Spring Boot 4 &amp; Spring Framework 7</a>.</p>

<h2 id="overzicht-van-alle-bronnen">Overzicht van alle bronnen</h2>

<table>
  <thead>
    <tr>
      <th>Resource</th>
      <th>Link</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>OpenRewrite recipes</td>
      <td><a href="https://docs.openrewrite.org/recipes/java">https://docs.openrewrite.org/recipes/java</a></td>
    </tr>
    <tr>
      <td>Spring Framework 7 HTTP Client</td>
      <td><a href="https://docs.spring.io/spring-framework/reference/integration/rest-clients.html#rest-request-factories">https://docs.spring.io/spring-framework/reference/integration/rest-clients.html#rest-request-factories</a></td>
    </tr>
    <tr>
      <td>Apache HttpClient 5 Migration</td>
      <td><a href="https://hc.apache.org/httpcomponents-client-5.6.x/migration-guide/preparation.html">https://hc.apache.org/httpcomponents-client-5.6.x/migration-guide/preparation.html</a></td>
    </tr>
    <tr>
      <td>Swagger (swagger-core)</td>
      <td><a href="https://github.com/swagger-api/swagger-core">https://github.com/swagger-api/swagger-core</a></td>
    </tr>
    <tr>
      <td>Spring Security 7 WebSocket (PR)</td>
      <td><a href="https://github.com/spring-projects/spring-security/pull/17328">https://github.com/spring-projects/spring-security/pull/17328</a></td>
    </tr>
    <tr>
      <td>Spring Security 7 (discussion thread)</td>
      <td><a href="https://github.com/spring-projects/spring-security/pull/17328">https://github.com/spring-projects/spring-security/pull/17328</a></td>
    </tr>
    <tr>
      <td>Spring Boot 4 &amp; Spring Framework 7 (overview)</td>
      <td><a href="https://www.baeldung.com/spring-boot-4-spring-framework-7">https://www.baeldung.com/spring-boot-4-spring-framework-7</a></td>
    </tr>
  </tbody>
</table>]]></content><author><name>Oumaima Zerouali</name><email>oumaima.zerouali@gmail.com</email></author><category term="java" /><category term="spring" /><category term="migration" /><category term="openrewrite" /><category term="softwaredevelopment" /><summary type="html"><![CDATA[“I’m ready… to break everything and figure it out later!” – SpongeBob SquarePants]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/img/migration-to-java-25.jpg" /><media:content medium="image" url="http://localhost:4000/assets/img/migration-to-java-25.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="en"><title type="html">Migration to Java 25 and Spring Boot 4: honestly, it was chaos</title><link href="http://localhost:4000/2026/01/22/migration-to-java-25/" rel="alternate" type="text/html" title="Migration to Java 25 and Spring Boot 4: honestly, it was chaos" /><published>2026-01-22T12:00:00+01:00</published><updated>2026-01-22T12:00:00+01:00</updated><id>http://localhost:4000/2026/01/22/migration-to-java-25</id><content type="html" xml:base="http://localhost:4000/2026/01/22/migration-to-java-25/"><![CDATA[<blockquote>
  <p>“I’m ready… to break everything and figure it out later!” – SpongeBob SquarePants</p>
</blockquote>

<p>Everyone always says that upgrading Spring is easy, right? Just run <strong>OpenRewrite</strong>, fix a few small things, and you’re done.</p>

<p>Well… let me tell you about our migration from <strong>Java 17/21 to Java 25</strong> and from <strong>Spring Boot 3 to 4.0.1</strong>.</p>

<p>For a single service it now takes at most an hour to fix everything. Not too bad. But I’ve already done this migration a few times for clients. And I keep running into the same problems, over and over again.</p>

<p>So I thought: let me write this down. Maybe it helps someone else who has to go through this migration.</p>

<h2 id="why-we-did-this-in-the-first-place">Why we did this in the first place</h2>

<p>Our tech lead wanted to move to <strong>Java 25</strong>. His reason? He always wants the newest version of everything. And honestly, I was pretty excited to experience a migration like this.</p>

<p>On top of that, we had to:</p>

<ul>
  <li>Upgrade to <strong>Spring Boot 4</strong> and <strong>Spring Framework 7</strong></li>
  <li>Fully finish the <strong>Jakarta migration</strong></li>
  <li>Clean up old code before adding new features</li>
</ul>

<p>All of our applications contain:</p>

<ul>
  <li>REST APIs</li>
  <li>Custom HTTP clients</li>
  <li>JWT security</li>
  <li>File uploads</li>
  <li>A lot of tests with MockMvc</li>
  <li>Jackson for JSON everywhere</li>
</ul>

<h2 id="openrewrite-helpful-but-not-magic">OpenRewrite: helpful, but not magic</h2>

<p>We started with <strong>OpenRewrite</strong> and the official Spring recipes (<a href="https://docs.openrewrite.org/recipes/java">source</a>).</p>

<p>What Rewrite did well:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">javax.*</code> → <code class="language-plaintext highlighter-rouge">jakarta.*</code></li>
  <li>Updating Spring imports</li>
  <li>Fixing deprecated APIs</li>
  <li>Adjusting config classes</li>
  <li><strong>Simplifying try-catch syntax</strong></li>
  <li><code class="language-plaintext highlighter-rouge">.additionalMessageConverters(new MappingJackson2HttpMessageConverter())</code> → <code class="language-plaintext highlighter-rouge">.additionalMessageConverters(new JacksonJsonHttpMessageConverter())</code></li>
  <li><code class="language-plaintext highlighter-rouge">.format(...)</code> → <code class="language-plaintext highlighter-rouge">.formatted(...)</code></li>
  <li><strong>Splitting YAML per profile</strong></li>
</ul>

<p><em>But… problems showed up pretty quickly.</em></p>

<h2 id="openrewrite--jdkjre-mismatch">OpenRewrite + JDK/JRE mismatch</h2>

<p>The first time I ran OpenRewrite on Java 25 it crashed with:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">LinkageError</span><span class="o">:</span> <span class="n">loader</span> <span class="n">constraint</span> <span class="nl">violation:</span> <span class="n">com</span><span class="o">.</span><span class="na">sun</span><span class="o">.</span><span class="na">tools</span><span class="o">.</span><span class="na">javac</span><span class="o">.</span><span class="na">parser</span><span class="o">.</span><span class="na">Tokens</span><span class="n">$Comment$CommentStyle</span>
</code></pre></div></div>

<p>Cause: <strong>JDK and JRE were not the same version</strong>.</p>

<p><strong>Fix:</strong></p>

<ul>
  <li>Always check that JDK and JRE are the same version</li>
  <li>For us: set both to <strong>Java 25</strong></li>
</ul>

<h2 id="everything-compiles--then-the-tests-explode">“Everything compiles!” … then the tests explode</h2>

<p>After Rewrite and fixing all compilation errors, we started the tests. And then? Everything failed.</p>

<p>Most problems were in:</p>

<ul>
  <li>MockMvc tests</li>
  <li>JSON serialization</li>
  <li>HTTP clients</li>
  <li>Jackson config</li>
</ul>

<h2 id="jackson-the-pain-that-never-ends">Jackson: the pain that never ends</h2>

<p>Spring Boot 4 moves Jackson from:</p>

<p>Old location:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">com</span><span class="o">.</span><span class="na">fasterxml</span><span class="o">.</span><span class="na">jackson</span><span class="o">.*</span>
</code></pre></div></div>

<p>New location:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tools</span><span class="o">.</span><span class="na">jackson</span><span class="o">.*</span>
</code></pre></div></div>

<p>Problems we ran into:</p>

<ul>
  <li>Mixed imports in tests</li>
  <li>Constants like <code class="language-plaintext highlighter-rouge">WRITE_DATES_AS_TIMESTAMPS</code> disappeared</li>
  <li>ObjectMapper conflicts, especially in tests with multiple primary beans</li>
</ul>

<p>Before we had:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="nd">@Primary</span>
<span class="nc">ObjectMapper</span> <span class="nf">objectMapper</span><span class="o">(</span><span class="nc">Jackson2ObjectMapperBuilder</span> <span class="n">builder</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">builder</span><span class="o">.</span><span class="na">dateFormat</span><span class="o">(...).</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p>In Boot 4:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Jackson2ObjectMapperBuilder</code> is <strong>deprecated</strong></li>
  <li>Boot creates its own <strong>primary</strong> <code class="language-plaintext highlighter-rouge">jacksonJsonMapper</code></li>
</ul>

<p>Result:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NoUniqueBeanDefinitionException:
more than one 'primary' bean found: [objectMapper, jacksonJsonMapper]
</code></pre></div></div>

<p><strong>New approach:</strong></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Bean</span>
<span class="kd">public</span> <span class="nc">ObjectMapper</span> <span class="nf">objectMapper</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="n">dateFormat</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SimpleDateFormat</span><span class="o">(</span><span class="s">"dd-MM-yyyy"</span><span class="o">);</span>

    <span class="k">return</span> <span class="nc">JsonMapper</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
            <span class="o">.</span><span class="na">defaultDateFormat</span><span class="o">(</span><span class="n">dateFormat</span><span class="o">)</span>
            <span class="o">.</span><span class="na">findAndAddModules</span><span class="o">()</span>
            <span class="o">.</span><span class="na">build</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Source:</strong> <a href="https://spring.io/blog/2025/10/07/introducing-jackson-3-support-in-spring">Introducing Jackson 3 support in Spring</a></p>

<h2 id="resttemplate--http-changes">RestTemplate &amp; HTTP changes</h2>

<h3 id="resttemplatebuilder-moved">RestTemplateBuilder moved</h3>

<p>Old location:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">web</span><span class="o">.</span><span class="na">client</span><span class="o">.</span><span class="na">RestTemplateBuilder</span>
</code></pre></div></div>

<p>New location:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">org</span><span class="o">.</span><span class="na">springframework</span><span class="o">.</span><span class="na">boot</span><span class="o">.</span><span class="na">restclient</span><span class="o">.</span><span class="na">RestTemplateBuilder</span>
</code></pre></div></div>

<blockquote>
  <p>In production code you’ll often migrate to <strong>RestClient</strong>, which Spring Boot 4 prefers.</p>
</blockquote>

<h3 id="response-api-changed">Response API changed</h3>

<p>Old way:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span><span class="o">.</span><span class="na">getStatusCodeValue</span><span class="o">()</span>
</code></pre></div></div>

<p>New way:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">response</span><span class="o">.</span><span class="na">getStatusCode</span><span class="o">().</span><span class="na">value</span><span class="o">()</span>
</code></pre></div></div>

<h3 id="headers-replaced">Headers replaced</h3>

<p>Old Apache way:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Header</span><span class="o">[]</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getAllHeaders</span><span class="o">();</span>
</code></pre></div></div>

<p>New Spring way:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">HttpHeaders</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getHeaders</span><span class="o">();</span>
</code></pre></div></div>

<h3 id="timeouts-are-now-builders">Timeouts are now builders</h3>

<p>The old setters no longer exist. New:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">HttpComponentsClientHttpRequestFactory</span> <span class="n">requestFactory</span> <span class="o">=</span>
    <span class="nc">ClientHttpRequestFactoryBuilder</span><span class="o">.</span><span class="na">httpComponents</span><span class="o">()</span>
        <span class="o">.</span><span class="na">withDefaultRequestConfigCustomizer</span><span class="o">(</span><span class="n">rc</span> <span class="o">-&gt;</span> <span class="n">rc</span>
            <span class="o">.</span><span class="na">setConnectTimeout</span><span class="o">(</span><span class="nc">Timeout</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span>
            <span class="o">.</span><span class="na">setConnectionRequestTimeout</span><span class="o">(</span><span class="nc">Timeout</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span>
            <span class="o">.</span><span class="na">setResponseTimeout</span><span class="o">(</span><span class="nc">Timeout</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span>
        <span class="o">)</span>
        <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</code></pre></div></div>

<p><strong>Custom HttpClients</strong> now have to be added via <code class="language-plaintext highlighter-rouge">.withHttpClientCustomizer(...)</code>.</p>

<p><strong>Source:</strong> <a href="https://docs.spring.io/spring-framework/reference/integration/rest-clients.html#rest-request-factories">Spring Framework 7 HTTP Client</a></p>

<h2 id="apache-httpclient-4--5">Apache HttpClient 4 → 5</h2>

<p>Everything changed:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">org.apache.http.*</code> → <code class="language-plaintext highlighter-rouge">org.apache.hc.*</code></li>
  <li>Timeouts, SSL, connection managers, request builders → complete rewrite</li>
</ul>

<p><strong>Source:</strong> <a href="https://hc.apache.org/httpcomponents-client-5.6.x/migration-guide/preparation.html">Apache HttpClient 5 Migration</a></p>

<h2 id="swagger--openapi-after-jakarta">Swagger &amp; OpenAPI after Jakarta</h2>

<p>After the migration, OpenAPI annotations disappear. Add:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>io.swagger.core.v3<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>swagger-annotations-jakarta<span class="nt">&lt;/artifactId&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<p><strong>Source:</strong> <a href="https://github.com/swagger-api/swagger-core">Swagger</a></p>

<h2 id="spring-security-7-websocket">Spring Security 7 WebSocket</h2>

<p><code class="language-plaintext highlighter-rouge">AbstractSecurityWebSocketMessageBrokerConfigurer</code> is gone. For us, this approach works:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.messaging.Message</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.authorization.AuthorizationDecision</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.authorization.AuthorizationManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.config.annotation.web.messaging.EnableWebSocketSecurity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.messaging.access.intercept.MessageAuthorizationContext</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.security.messaging.access.intercept.MessageMatcherDelegatingAuthorizationManager</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="nd">@EnableWebSocketSecurity</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebSocketSecurityConfig</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">AuthorizationManager</span><span class="o">&lt;</span><span class="nc">Message</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">messageAuthorizationManager</span><span class="o">(</span>
            <span class="nc">MessageMatcherDelegatingAuthorizationManager</span><span class="o">.</span><span class="na">Builder</span> <span class="n">messages</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">messages</span>
                <span class="o">.</span><span class="na">nullDestMatcher</span><span class="o">().</span><span class="na">permitAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">simpSubscribeDestMatchers</span><span class="o">(</span><span class="s">"/**"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">simpDestMatchers</span><span class="o">(</span><span class="s">"/**"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
                <span class="o">.</span><span class="na">anyMessage</span><span class="o">().</span><span class="na">permitAll</span><span class="o">();</span>
        <span class="k">return</span> <span class="n">messages</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">AuthorizationManager</span><span class="o">&lt;</span><span class="nc">MessageAuthorizationContext</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">authorizationManager</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">AuthorizationDecision</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><strong>Source:</strong> <a href="https://newreleases.io/project/github/spring-projects/spring-security/release/7.0.0-M1">Spring Security 7 WebSocket</a>,
<a href="https://github.com/spring-projects/spring-security/pull/17328">Github Thread</a></p>

<h2 id="recurring-problems">Recurring problems</h2>

<p>During the migration, most issues kept coming back, especially in tests:</p>

<ul>
  <li>Jackson namespace constantly breaks</li>
  <li>ObjectMapper conflicts in tests</li>
  <li>HTTP client configuration has to be fully rewritten</li>
  <li>Response handling methods changed</li>
  <li>RestTemplate and builders have new imports or are replaced by RestClient</li>
  <li>Tests often fail even though compilation succeeds</li>
</ul>

<p>On top of that, the compiler, serialization layer, SSL configuration, and auto-configuration all get affected at the same time by the upgrade.</p>

<h2 id="what-i-would-recommend">What I would recommend</h2>

<ul>
  <li>Plan extra time for tests</li>
  <li>Expect Jackson problems and ObjectMapper conflicts</li>
  <li>Be prepared to rewrite HTTP client code</li>
  <li>Run your full test suite early and often</li>
  <li>Use OpenRewrite</li>
</ul>

<p>Personally, I’m glad I got to do this migration myself. Despite the frustrations and all the documentation reading, it gave me a much deeper understanding of how Spring Boot and Spring Framework work and how much control they have over infrastructure and configuration.</p>

<p>Want to learn more about Spring Boot 4 and Spring Framework 7? Check out this post: <a href="https://www.baeldung.com/spring-boot-4-spring-framework-7">Spring Boot 4 &amp; Spring Framework 7</a>.</p>

<h2 id="overview-of-all-sources">Overview of all sources</h2>

<table>
  <thead>
    <tr>
      <th>Resource</th>
      <th>Link</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>OpenRewrite recipes</td>
      <td><a href="https://docs.openrewrite.org/recipes/java">https://docs.openrewrite.org/recipes/java</a></td>
    </tr>
    <tr>
      <td>Spring Framework 7 HTTP Client</td>
      <td><a href="https://docs.spring.io/spring-framework/reference/integration/rest-clients.html#rest-request-factories">https://docs.spring.io/spring-framework/reference/integration/rest-clients.html#rest-request-factories</a></td>
    </tr>
    <tr>
      <td>Apache HttpClient 5 Migration</td>
      <td><a href="https://hc.apache.org/httpcomponents-client-5.6.x/migration-guide/preparation.html">https://hc.apache.org/httpcomponents-client-5.6.x/migration-guide/preparation.html</a></td>
    </tr>
    <tr>
      <td>Swagger (swagger-core)</td>
      <td><a href="https://github.com/swagger-api/swagger-core">https://github.com/swagger-api/swagger-core</a></td>
    </tr>
    <tr>
      <td>Spring Security 7 WebSocket (PR)</td>
      <td><a href="https://github.com/spring-projects/spring-security/pull/17328">https://github.com/spring-projects/spring-security/pull/17328</a></td>
    </tr>
    <tr>
      <td>Spring Security 7 (discussion thread)</td>
      <td><a href="https://github.com/spring-projects/spring-security/pull/17328">https://github.com/spring-projects/spring-security/pull/17328</a></td>
    </tr>
    <tr>
      <td>Spring Boot 4 &amp; Spring Framework 7 (overview)</td>
      <td><a href="https://www.baeldung.com/spring-boot-4-spring-framework-7">https://www.baeldung.com/spring-boot-4-spring-framework-7</a></td>
    </tr>
  </tbody>
</table>]]></content><author><name>Oumaima Zerouali</name><email>oumaima.zerouali@gmail.com</email></author><category term="java" /><category term="spring" /><category term="migration" /><category term="openrewrite" /><category term="softwaredevelopment" /><summary type="html"><![CDATA[“I’m ready… to break everything and figure it out later!” – SpongeBob SquarePants]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/img/migration-to-java-25.jpg" /><media:content medium="image" url="http://localhost:4000/assets/img/migration-to-java-25.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="nl"><title type="html">Testcontainers in Spring Boot: Van Snelle Winst tot Geavanceerde Zetten</title><link href="http://localhost:4000/nl/2025/10/05/testcontainers/" rel="alternate" type="text/html" title="Testcontainers in Spring Boot: Van Snelle Winst tot Geavanceerde Zetten" /><published>2025-10-05T09:00:00+02:00</published><updated>2025-10-05T09:00:00+02:00</updated><id>http://localhost:4000/nl/2025/10/05/testcontainers</id><content type="html" xml:base="http://localhost:4000/nl/2025/10/05/testcontainers/"><![CDATA[<blockquote>
  <p>“Testcontainers is like having SpongeBob at the helm of your CI: cheerful, reliable, and somehow turning chaos into perfection.” - Me</p>
</blockquote>

<p>Als junior developer ben ik constant nieuwe tools en werkwijzen aan het leren.<br />
Een les van mijn senioren die echt bij me bleef hangen was deze: <em>mocking brengt je maar tot een bepaald punt</em>.<br />
Op een gegeven moment moet je testen tegen het echte werk: een echte database, een echte message broker, een echte service.</p>

<p>Toen ontdekte ik <strong>Testcontainers</strong>, en het veranderde volledig hoe ik integratietests schrijf in Java en Spring Boot.<br />
Na ermee te hebben geëxperimenteerd en mijn bevindingen te hebben gedeeld met collega’s, besefte ik dat ik alles wat ik had geleerd op één plek wilde vastleggen.</p>

<p>Deze post is mijn poging dat te doen: het uitleggen van het <strong>waarom</strong>, het <strong>hoe</strong>, en de <strong>praktijkpatronen</strong> die ik nu in mijn projecten gebruik.</p>

<h2 id="het-probleem-dat-ik-eerder-had">Het Probleem dat Ik Eerder Had</h2>
<p>Ik moet toegeven:<br />
ik probeerde integratietests altijd te vermijden wanneer ik kon.<br />
Mocks waren mijn beste vrienden: snel, voorspelbaar, en makkelijk op te zetten.</p>

<p>Maar hoe graag ik ze ook gebruikte, sommige dingen kun je gewoon niet faken.<br />
Een mailserver, een echte PostgreSQL-database — geen enkele mock kon dat echt repliceren.</p>

<p>Ik liep al snel tegen dezelfde frustrerende scenario’s aan die we allemaal kennen: tests die op mijn machine slagen maar falen in CI, of collega’s die uren besteden aan het klaarmaken van de omgeving om tests te kunnen draaien.</p>

<p>Voor een Spring Boot-app die PostgreSQL nodig heeft en e-mails verstuurt, zien de opties er zo uit:</p>

<table>
  <thead>
    <tr>
      <th>Benadering</th>
      <th>Voordelen</th>
      <th>Nadelen</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Lokale installatie</strong><br />Installeer PostgreSQL &amp; SMTP lokaal</td>
      <td>- Testen tegen echte services<br /> - Geen mocking nodig</td>
      <td>- Verschillende versies op verschillende machines<br /> - “Werkt op mijn laptop” syndroom<br /> - Pijnlijke CI-setup<br /> - Achtergebleven testdata</td>
    </tr>
    <tr>
      <td><strong>Alles mocken</strong><br />Gebruik mock databases &amp; services</td>
      <td>- Snelle testuitvoering<br /> - Geen externe afhankelijkheden</td>
      <td>- Test geen echte integratie<br /> - Mocks wijken af van de werkelijkheid<br /> - Valse zekerheid</td>
    </tr>
    <tr>
      <td><strong>Testcontainers</strong><br />Echte services in Docker</td>
      <td>- Echte integratietests<br /> - Consistent op alle machines<br /> - Geen installatie gedoe<br /> - Schone staat bij elke run</td>
      <td>- Vereist Docker<br /> - Iets langzamer dan mocks</td>
    </tr>
  </tbody>
</table>

<p><strong>Testcontainers</strong> was de game-changer die ik nodig had.</p>

<h2 id="snel-aan-de-slag">Snel aan de Slag</h2>

<p>Voordat ik dieper inga, eerst een setup:</p>

<p><strong>Vereisten:</strong></p>
<ul>
  <li>Java <strong>21+</strong></li>
  <li>Maven</li>
  <li>Docker Desktop draaiend</li>
</ul>

<p><strong>Dependencies toevoegen:</strong></p>

<p>Maven:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.testcontainers<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>junit-jupiter<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.testcontainers<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>postgresql<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<h2 id="de-standaardaanpak-goed-maar-beperkt">De Standaardaanpak (Goed, Maar Beperkt)</h2>

<p>De meeste tutorials laten dit zien, en eerlijk, het werkt prima voor eenvoudige cases:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Testcontainers</span>
<span class="nd">@DataJpaTest</span>
<span class="kd">class</span> <span class="nc">UserRepositoryTest</span> <span class="o">{</span>

    <span class="nd">@Container</span>
    <span class="kd">static</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;?&gt;</span> <span class="n">postgres</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;&gt;(</span><span class="s">"postgres:16-alpine"</span><span class="o">);</span>
    
    <span class="nd">@DynamicPropertySource</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">configureProperties</span><span class="o">(</span><span class="nc">DynamicPropertyRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">registry</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"spring.datasource.url"</span><span class="o">,</span> <span class="nl">postgres:</span><span class="o">:</span><span class="n">getJdbcUrl</span><span class="o">);</span>
        <span class="n">registry</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"spring.datasource.username"</span><span class="o">,</span> <span class="nl">postgres:</span><span class="o">:</span><span class="n">getUsername</span><span class="o">);</span>
        <span class="n">registry</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"spring.datasource.password"</span><span class="o">,</span> <span class="nl">postgres:</span><span class="o">:</span><span class="n">getPassword</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="nd">@Autowired</span>
    <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
    
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">givenNewUser_whenSaving_thenUserIsPersisted</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="s">"Spongebob"</span><span class="o">);</span>
        <span class="n">userRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">().</span><span class="na">size</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Perfect voor eenvoudige gevallen. JUnit start een PostgreSQL-container, Spring Boot configureert deze via <code class="language-plaintext highlighter-rouge">@DynamicPropertySource</code>, de test draait tegen een echte database, en de container wordt netjes opgeruimd na afloop.</p>

<h3 id="wat-gebeurt-er-achter-de-schermen">Wat Gebeurt Er Achter de Schermen?</h3>

<p>Wanneer je op “Run Test” klikt, gebeurt dit (vereenvoudigd):</p>

<p align="center">
    <img src="/assets/img/simplified.svg" alt="Achter de schermen (vereenvoudigd)" style="height: 550px" />
</p>

<p>Het wachten is cruciaal.
Testcontainers kijkt niet alleen of de poort open is, maar wacht totdat de service daadwerkelijk klaar is om verbindingen te accepteren.
Daarom werken je tests “gewoon” zonder flakey failures.</p>

<p>Maar in echte projecten liep ik al snel tegen situaties aan waarbij ik moest:</p>

<ul>
  <li>Meerdere containers starten die met elkaar praten</li>
  <li>Mijn database vooraf vullen met schema of seed data</li>
  <li>Wachten tot een REST API klaar is, niet alleen een poort</li>
  <li>E-mails testen tegen een fake SMTP-server</li>
</ul>

<p>Daar wordt het pas interessant…</p>

<h2 id="volgende-stap-applicationcontextinitializer">Volgende Stap: ApplicationContextInitializer</h2>

<p>Wanneer ik meer controle nodig heb, biedt Spring Boot een krachtige hook:
<strong><code class="language-plaintext highlighter-rouge">ApplicationContextInitializer&lt;ConfigurableApplicationContext&gt;</code></strong>.</p>

<p>Dit draait <strong>voordat</strong> je applicatiecontext start, en laat je toe om:</p>

<ul>
  <li>Containers handmatig te starten met volledige controle</li>
  <li>Complexe wachtstrategieën te configureren</li>
  <li>Custom properties in Spring’s environment te injecteren</li>
  <li>Containerconfiguraties te hergebruiken over meerdere testklassen</li>
</ul>

<p>Ik zie dit als de “professionele” manier om Testcontainers in Spring Boot op te zetten.</p>

<h3 id="hoe-de-professionele-setup-werkt">Hoe de Professionele Setup Werkt</h3>

<p>Wanneer je <code class="language-plaintext highlighter-rouge">ApplicationContextInitializer</code> gebruikt, gebeurt dit:</p>

<p align="center">
    <img src="/assets/img/testcontainers.svg" alt="Wat gebeurt bij ApplicationContextInitializer" style="height: 550px" />
</p>

<p>Je krijgt volledige controle over de opstartvolgorde en kunt containers precies configureren zoals jij wilt.</p>

<h3 id="praktijkvoorbeeld-e-mails-testen-met-smtp4dev-of-mailpit">Praktijkvoorbeeld: E-mails testen met smtp4dev (of Mailpit)</h3>

<p>Mijn app verstuurt e-mails, en ik moest realistisch testen zonder echte inboxen te spammen.</p>

<p><strong>smtp4dev</strong> is een fake SMTP-server die e-mails opvangt en via een REST API beschikbaar stelt.
Het bestaat al jaren, is volwassen en biedt features zoals relay-testing en authenticatiesimulatie.
Perfect voor uitgebreide e-mailtests.</p>

<p><strong>Mailpit</strong> is een modern alternatief geschreven in Go: lichter, sneller opstartend, en met een strakke UI.
Ook uitstekende zoekfunctionaliteit en ingebouwde spam-analyse.
Voor nieuwe projecten in 2025 is Mailpit vaak de go-to, maar smtp4dev blijft solide voor bestaande projecten.</p>

<p>Beide bieden REST APIs, ondersteunen SMTP-authenticatie en hebben een web UI voor handmatige inspectie.
Belangrijkste verschillen:</p>

<ul>
  <li><strong>Performance</strong>: Mailpit start sneller en gebruikt minder geheugen (~10-20MB vs ~50-100MB)</li>
  <li><strong>UI</strong>: Mailpit heeft een moderne, responsive interface</li>
  <li><strong>Features</strong>: smtp4dev heeft meer enterprise-features; Mailpit focust op eenvoud</li>
  <li><strong>Docker grootte</strong>: Mailpit image is kleiner (~15MB vs ~200MB)</li>
</ul>

<p>Voor de meeste Spring Boot integratietests werkt beide prima.
Hier laat ik smtp4dev zien, maar switchen naar Mailpit is simpel door de image naam te veranderen.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Smtp4devTestContainerInitializer</span> <span class="kd">implements</span> <span class="nc">ApplicationContextInitializer</span><span class="o">&lt;</span><span class="nc">ConfigurableApplicationContext</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">GenericContainer</span><span class="o">&lt;?&gt;</span> <span class="n">smtp4devContainer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GenericContainer</span><span class="o">&lt;&gt;(</span><span class="nc">DockerImageName</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"rnwood/smtp4dev:3.10.3"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">withExposedPorts</span><span class="o">(</span><span class="mi">80</span><span class="o">,</span> <span class="mi">25</span><span class="o">)</span>
        <span class="o">.</span><span class="na">waitingFor</span><span class="o">(</span><span class="nc">Wait</span><span class="o">.</span><span class="na">forHttp</span><span class="o">(</span><span class="s">"/api/messages"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">forPort</span><span class="o">(</span><span class="mi">80</span><span class="o">)</span>
        <span class="o">.</span><span class="na">forStatusCode</span><span class="o">(</span><span class="mi">200</span><span class="o">));</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="nc">ConfigurableApplicationContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">smtp4devContainer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        
        <span class="nc">TestPropertyValues</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
        <span class="s">"spring.mail.host="</span> <span class="o">+</span> <span class="n">smtp4devContainer</span><span class="o">.</span><span class="na">getHost</span><span class="o">(),</span>
        <span class="s">"spring.mail.port="</span> <span class="o">+</span> <span class="n">smtp4devContainer</span><span class="o">.</span><span class="na">getMappedPort</span><span class="o">(</span><span class="mi">25</span><span class="o">)</span>
        <span class="o">).</span><span class="na">applyTo</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Nu in een test:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootTest</span>
<span class="nd">@ContextConfiguration</span><span class="o">(</span><span class="n">initializers</span> <span class="o">=</span> <span class="nc">Smtp4devTestContainerInitializer</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">KrustyKrabEmailServiceTest</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="nc">EmailService</span> <span class="n">emailService</span><span class="o">;</span>
    
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">givenBikiniBottomCitizen_whenSendingWelcome_thenMessageSends</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">emailService</span><span class="o">.</span><span class="na">sendWelcome</span><span class="o">(</span><span class="s">"patrick.star@bikinibottom.com"</span><span class="o">);</span>
        
        <span class="nc">RestTemplate</span> <span class="n">rest</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RestTemplate</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">messagesApi</span> <span class="o">=</span> <span class="s">"http://"</span> <span class="o">+</span>
        <span class="nc">Smtp4devTestContainerInitializer</span><span class="o">.</span><span class="na">smtp4devContainer</span><span class="o">.</span><span class="na">getHost</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span>
        <span class="nc">Smtp4devTestContainerInitializer</span><span class="o">.</span><span class="na">smtp4devContainer</span><span class="o">.</span><span class="na">getMappedPort</span><span class="o">(</span><span class="mi">80</span><span class="o">)</span> <span class="o">+</span>
        <span class="s">"/api/messages"</span><span class="o">;</span>
        
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;&gt;</span> <span class="n">messages</span> <span class="o">=</span> <span class="n">rest</span><span class="o">.</span><span class="na">getForObject</span><span class="o">(</span><span class="n">messagesApi</span><span class="o">,</span> <span class="nc">List</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">messages</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">messages</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="s">"subject"</span><span class="o">).</span><span class="na">toString</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"Welcome"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Belangrijke punten:</p>

<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">withExposedPorts(80, 25)</code></strong> → web UI + SMTP poort openstellen</li>
  <li><strong><code class="language-plaintext highlighter-rouge">waitingFor(Wait.forHttp(...))</code></strong> → wachten tot de API echt klaar is</li>
  <li><strong><code class="language-plaintext highlighter-rouge">TestPropertyValues</code></strong> → configureert container-instellingen in Spring</li>
</ul>

<p>Wil je <strong>Mailpit</strong> gebruiken? Zo ziet de initializer eruit:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MailpitTestContainerInitializer</span> <span class="kd">implements</span> <span class="nc">ApplicationContextInitializer</span><span class="o">&lt;</span><span class="nc">ConfigurableApplicationContext</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">GenericContainer</span><span class="o">&lt;?&gt;</span> <span class="n">mailpitContainer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GenericContainer</span><span class="o">&lt;&gt;(</span><span class="nc">DockerImageName</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"axllent/mailpit:v1.27.8"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">withExposedPorts</span><span class="o">(</span><span class="mi">8025</span><span class="o">,</span> <span class="mi">1025</span><span class="o">)</span>
        <span class="o">.</span><span class="na">waitingFor</span><span class="o">(</span><span class="nc">Wait</span><span class="o">.</span><span class="na">forHttp</span><span class="o">(</span><span class="s">"/api/v1/messages"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">forPort</span><span class="o">(</span><span class="mi">8025</span><span class="o">)</span>
        <span class="o">.</span><span class="na">forStatusCode</span><span class="o">(</span><span class="mi">200</span><span class="o">));</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="nc">ConfigurableApplicationContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mailpitContainer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        
        <span class="nc">TestPropertyValues</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
        <span class="s">"spring.mail.host="</span> <span class="o">+</span> <span class="n">mailpitContainer</span><span class="o">.</span><span class="na">getHost</span><span class="o">(),</span>
        <span class="s">"spring.mail.port="</span> <span class="o">+</span> <span class="n">mailpitContainer</span><span class="o">.</span><span class="na">getMappedPort</span><span class="o">(</span><span class="mi">1025</span><span class="o">)</span>
        <span class="o">).</span><span class="na">applyTo</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Verschillen:</p>

<ul>
  <li>Poort 8025 voor web UI (ipv 80 bij smtp4dev)</li>
  <li>Poort 1025 voor SMTP (ipv 25)</li>
  <li>API pad <code class="language-plaintext highlighter-rouge">/api/v1/messages</code> ipv <code class="language-plaintext highlighter-rouge">/api/messages</code></li>
</ul>

<p>Beide werken identiek in je tests. Kies smtp4dev voor geavanceerde relay-features of bestaande projecten, Mailpit voor snelle opstart en kleine Docker footprint.</p>

<h3 id="postgresql-met-initialisatie-scripts">PostgreSQL met Initialisatie Scripts</h3>

<p>Soms wil ik geen lege database, maar schema + seed data laden:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDatabaseInitializer</span> <span class="kd">implements</span> <span class="nc">ApplicationContextInitializer</span><span class="o">&lt;</span><span class="nc">ConfigurableApplicationContext</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;?&gt;</span> <span class="n">postgres</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;&gt;(</span><span class="s">"postgres:16-alpine"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">withDatabaseName</span><span class="o">(</span><span class="s">"myapp"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">withCopyFileToContainer</span><span class="o">(</span><span class="nc">MountableFile</span><span class="o">.</span><span class="na">forClasspathResource</span><span class="o">(</span><span class="s">"init_schema.sql"</span><span class="o">),</span> <span class="s">"/docker-entrypoint-initdb.d/"</span><span class="o">);</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="nc">ConfigurableApplicationContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">postgres</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        
        <span class="nc">TestPropertyValues</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
        <span class="s">"spring.datasource.url="</span> <span class="o">+</span> <span class="n">postgres</span><span class="o">.</span><span class="na">getJdbcUrl</span><span class="o">(),</span>
        <span class="s">"spring.datasource.username="</span> <span class="o">+</span> <span class="n">postgres</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span>
        <span class="s">"spring.datasource.password="</span> <span class="o">+</span> <span class="n">postgres</span><span class="o">.</span><span class="na">getPassword</span><span class="o">()</span>
        <span class="o">).</span><span class="na">applyTo</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>De truc: <strong><code class="language-plaintext highlighter-rouge">withCopyFileToContainer</code></strong> → schema in <code class="language-plaintext highlighter-rouge">/docker-entrypoint-initdb.d/</code> plaatsen. Postgres voert dit automatisch uit bij opstart.</p>

<h2 id="gespecialiseerde-containers-vs-genericcontainer">Gespecialiseerde Containers vs GenericContainer</h2>

<p>Je ziet dat ik zowel <code class="language-plaintext highlighter-rouge">PostgreSQLContainer</code> als <code class="language-plaintext highlighter-rouge">GenericContainer</code> heb gebruikt.</p>

<p>Regel van thumb:</p>

<ul>
  <li><strong>Gebruik gespecialiseerde containers</strong> als ze bestaan (<code class="language-plaintext highlighter-rouge">PostgreSQLContainer</code>, <code class="language-plaintext highlighter-rouge">MongoDBContainer</code>, <code class="language-plaintext highlighter-rouge">KafkaContainer</code>, …) → handige defaults en shortcuts</li>
  <li><strong>Gebruik <code class="language-plaintext highlighter-rouge">GenericContainer</code></strong> voor alles wat geen module heeft (smtp4dev, Mailpit, custom images)</li>
</ul>

<p>Denk aan <code class="language-plaintext highlighter-rouge">GenericContainer</code> als het <strong>Zwitsers zakmes</strong> van Testcontainers. Alles anders bouwt hierop voort.</p>

<h2 id="tips-uit-de-praktijk">Tips uit de praktijk</h2>

<h4 id="containers-hergebruiken-over-tests"><strong>Containers hergebruiken over tests</strong></h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Container</span>
<span class="kd">static</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;?&gt;</span> <span class="n">postgres</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;&gt;(</span><span class="s">"postgres:16.3"</span><span class="o">);</span>
</code></pre></div></div>

<p>Maak ze <code class="language-plaintext highlighter-rouge">static</code> om herstarten per methode te vermijden. Waarom dit belangrijk is:</p>

<p align="center">
    <img src="/assets/img/static_1.svg" alt="Zonder static" style="height: 550px; margin-bottom: -400px; margin-top: -200px" />
    <img src="/assets/img/static_2.svg" alt="Met static" style="height: 550px; margin-top: -100px; margin-bottom: -200px" />
</p>

<h4 id="pin-image-versies"><strong>Pin image versies</strong></h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;&gt;(</span><span class="s">"postgres:16-alpine"</span><span class="o">);</span> <span class="c1">// stabiel</span>
<span class="k">new</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;&gt;(</span><span class="s">"postgres:latest"</span><span class="o">);</span> <span class="c1">// risicovol</span>
</code></pre></div></div>

<h4 id="initializers-delen-tussen-testklassen"><strong>Initializers delen</strong> tussen testklassen</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootTest</span>
<span class="nd">@ContextConfiguration</span><span class="o">(</span><span class="n">initializers</span> <span class="o">=</span> <span class="o">{</span>
<span class="nc">TestDatabaseInitializer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
<span class="nc">Smtp4devTestContainerInitializer</span><span class="o">.</span><span class="na">class</span>
<span class="o">})</span>
<span class="kd">class</span> <span class="nc">MyIntegrationTest</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
</code></pre></div></div>

<h4 id="maak-je-geen-zorgen-om-test-snelheid"><strong>Maak je geen zorgen om test snelheid</strong></h4>

<p>Ja, Docker-containers nemen een paar seconden om te starten.
Maar met static containers en hergebruik is de opstarttijd minimaal vergeleken met de zekerheid die je krijgt.
Mijn test suite met PostgreSQL en smtp4dev voegt misschien 5–10 seconden toe — de moeite waard.</p>

<h4 id="check-logs-bij-debuggen"><strong>Check logs bij debuggen</strong></h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">postgres</span><span class="o">.</span><span class="na">getLogs</span><span class="o">());</span>
</code></pre></div></div>

<h2 id="afronden">Afronden</h2>

<p>Testcontainers heeft mijn manier van integratietesten volledig veranderd.</p>

<p>Ik begon met <code class="language-plaintext highlighter-rouge">@Container</code> en <code class="language-plaintext highlighter-rouge">@DynamicPropertySource</code> voor eenvoudige gevallen.
Wanneer ik meer controle nodig had, gebruikte ik <code class="language-plaintext highlighter-rouge">ApplicationContextInitializer</code>.
En bij testen tegen elke Docker image bood <code class="language-plaintext highlighter-rouge">GenericContainer</code> uitkomst.</p>

<p>Het mooie: ik test altijd <strong>tegen het echte werk</strong>.
Echte databases, echte SMTP-servers, echte API’s, zonder de traditionele ellende van lokaal beheer.</p>

<p>Als je Testcontainers nog niet gebruikt, probeer het dan zeker in je volgende Spring Boot-project.
Je toekomstige zelf (en je team) zal je dankbaar zijn.</p>

<p>Ga nu aan de slag en containerize je tests!</p>

<h2 id="bronnen">Bronnen</h2>

<p><strong>Officiële documentatie:</strong></p>

<ul>
  <li><a href="https://www.testcontainers.org/">Testcontainers Official Documentation</a></li>
  <li><a href="https://java.testcontainers.org/">Testcontainers for Java</a></li>
  <li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing">Spring Boot Testing Documentation</a></li>
</ul>

<p><strong>Docker images gebruikt:</strong></p>

<ul>
  <li><a href="https://hub.docker.com/_/postgres">PostgreSQL on Docker Hub</a></li>
  <li><a href="https://github.com/rnwood/smtp4dev">smtp4dev on GitHub</a></li>
  <li><a href="https://github.com/axllent/mailpit">Mailpit on GitHub</a></li>
</ul>

<p><strong>Gerelateerde tools:</strong></p>

<ul>
  <li><a href="https://www.docker.com/products/docker-desktop/">Docker Desktop</a></li>
  <li><a href="https://mvnrepository.com/artifact/org.testcontainers">Maven Central - Testcontainers</a></li>
</ul>]]></content><author><name>Oumaima Zerouali</name><email>oumaima.zerouali@gmail.com</email></author><category term="java" /><category term="spring-boot" /><category term="testing" /><category term="docker" /><summary type="html"><![CDATA[“Testcontainers is like having SpongeBob at the helm of your CI: cheerful, reliable, and somehow turning chaos into perfection.” - Me]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/img/spongebob-testcontainers.png" /><media:content medium="image" url="http://localhost:4000/assets/img/spongebob-testcontainers.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="en"><title type="html">Testcontainers in Spring Boot: From Quick Wins to Power Moves</title><link href="http://localhost:4000/2025/10/05/testcontainers/" rel="alternate" type="text/html" title="Testcontainers in Spring Boot: From Quick Wins to Power Moves" /><published>2025-10-05T09:00:00+02:00</published><updated>2025-10-05T09:00:00+02:00</updated><id>http://localhost:4000/2025/10/05/testcontainers</id><content type="html" xml:base="http://localhost:4000/2025/10/05/testcontainers/"><![CDATA[<blockquote>
  <p>“Testcontainers is like having SpongeBob at the helm of your CI: cheerful, reliable, and somehow turning chaos into perfection.” - Me</p>
</blockquote>

<p>As a junior developer, I’m constantly learning new tools and practices.
One lesson from my seniors that really stuck with me was this: <em>mocking will only take you so far</em>.
At some point, you need to test against the real thing: a real database, a real message broker, a real service.</p>

<p>That’s when I discovered <strong>Testcontainers</strong>, and it completely changed how I write integration tests in Java and Spring Boot.
After experimenting with it and sharing my findings with colleagues, I realized I wanted to capture everything I’d learned in one place.</p>

<p>This post is my attempt to do just that: explaining the why, the how, and the real-world patterns I now use in my projects.</p>

<h2 id="the-problem-i-used-to-have">The Problem I Used to Have</h2>
<p>I have to admit.
I used to avoid integration tests whenever I could.
Mocks were my best friends: fast, predictable, and easy to set up.</p>

<p>But as much as I loved them, some things just can’t be faked.
A mail server, a real PostgreSQL database, no amount of mocking could truly replicate them.</p>

<p>I quickly ran into the same frustrating scenarios we’ve all seen: tests that pass on my machine but fail in CI, or teammates spending hours just to get the environment ready to run tests.</p>

<p>For a Spring Boot app that needs PostgreSQL and sends emails, here’s how the options stack up:</p>

<table>
  <thead>
    <tr>
      <th>Approach</th>
      <th>Pros</th>
      <th>Cons</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Local Installation</strong><br />Install PostgreSQL &amp; SMTP locally</td>
      <td>- Tests against real services<br /> - No mocking</td>
      <td>- Different versions across machines<br /> - “Works on my laptop” syndrome<br /> - Painful CI setup<br /> - Leftover test data pollution</td>
    </tr>
    <tr>
      <td><strong>Mock Everything</strong><br />Use mock databases &amp; services</td>
      <td>- Fast test execution<br /> - No external dependencies</td>
      <td>- Not testing real integration<br /> - Mocks drift from reality<br /> - False confidence</td>
    </tr>
    <tr>
      <td><strong>Testcontainers</strong><br />Real services in Docker</td>
      <td>- Real integration testing<br /> - Consistent across all machines<br /> - Zero installation hassle<br /> - Clean state every run</td>
      <td>- Requires Docker<br /> - Slightly slower than mocks</td>
    </tr>
  </tbody>
</table>

<p><strong>Testcontainers</strong> was the game-changer I needed.</p>

<h2 id="quick-setup">Quick Setup</h2>

<p>Before I dive deep, let me get you set up:</p>

<p><strong>Prerequisites:</strong></p>
<ul>
  <li>Java <strong>21+</strong></li>
  <li>Maven</li>
  <li>Docker Desktop running</li>
</ul>

<p><strong>Add the dependencies:</strong></p>

<p>Maven:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.testcontainers<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>junit-jupiter<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>

<span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.testcontainers<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>postgresql<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></div></div>

<h2 id="the-standard-approach-good-but-limited">The Standard Approach (Good, But Limited)</h2>

<p>Here’s what most tutorials show you, and honestly, it’s great for simple cases:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Testcontainers</span>
<span class="nd">@DataJpaTest</span>
<span class="kd">class</span> <span class="nc">UserRepositoryTest</span> <span class="o">{</span>

    <span class="nd">@Container</span>
    <span class="kd">static</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;?&gt;</span> <span class="n">postgres</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;&gt;(</span><span class="s">"postgres:16-alpine"</span><span class="o">);</span>
    
    <span class="nd">@DynamicPropertySource</span>
    <span class="kd">static</span> <span class="kt">void</span> <span class="nf">configureProperties</span><span class="o">(</span><span class="nc">DynamicPropertyRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">registry</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"spring.datasource.url"</span><span class="o">,</span> <span class="nl">postgres:</span><span class="o">:</span><span class="n">getJdbcUrl</span><span class="o">);</span>
        <span class="n">registry</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"spring.datasource.username"</span><span class="o">,</span> <span class="nl">postgres:</span><span class="o">:</span><span class="n">getUsername</span><span class="o">);</span>
        <span class="n">registry</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">"spring.datasource.password"</span><span class="o">,</span> <span class="nl">postgres:</span><span class="o">:</span><span class="n">getPassword</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="nd">@Autowired</span>
    <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>
    
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">givenNewUser_whenSaving_thenUserIsPersisted</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="s">"Spongebob"</span><span class="o">);</span>
        <span class="n">userRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">().</span><span class="na">size</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This is <strong>beautiful</strong> for simple cases. JUnit starts a PostgreSQL container, Spring Boot wires it up via <code class="language-plaintext highlighter-rouge">@DynamicPropertySource</code>, your test runs against a real database, and the container gets cleaned up afterward.</p>

<h3 id="what-actually-happens-behind-the-scenes">What Actually Happens Behind the Scenes?</h3>

<p>When you hit “Run Test”, here’s the magic that unfolds (simplified):</p>

<p align="center">
    <img src="/assets/img/simplified.svg" alt="Behind the scenes (simplified)" style="height: 550px" />
</p>

<p>The waiting phase is crucial. 
Testcontainers doesn’t just check if the port is open, it waits until the service is actually ready to accept connections. 
This is why your tests “just work” without flaky failures.</p>

<p>But in real projects, I quickly ran into situations where I needed to:</p>

<ul>
  <li>Start multiple containers that talk to each other</li>
  <li>Preload my database with schema or seed data</li>
  <li>Wait for a REST API to be ready, not just a port</li>
  <li>Test email sending against a fake SMTP server</li>
</ul>

<p>That’s where things get interesting….</p>

<h2 id="level-up-applicationcontextinitializer">Level Up: ApplicationContextInitializer</h2>

<p>When I need more control, Spring Boot gives me a powerful hook:
<strong><code class="language-plaintext highlighter-rouge">ApplicationContextInitializer&lt;ConfigurableApplicationContext&gt;</code></strong>.</p>

<p>This runs <strong>before</strong> your application context starts, letting you:</p>

<ul>
  <li>Start containers manually with full control</li>
  <li>Configure complex wait strategies</li>
  <li>Inject custom properties into Spring’s environment</li>
  <li>Reuse container configurations across multiple test classes</li>
</ul>

<p>I think of it as the “professional” way to wire up Testcontainers in Spring Boot.</p>

<h3 id="how-the-professional-setup-works">How the Professional Setup Works</h3>

<p>Here’s what happens when you use <code class="language-plaintext highlighter-rouge">ApplicationContextInitializer</code>:</p>

<p align="center">
    <img src="/assets/img/testcontainers.svg" alt="What happens when you use ApplicationContextInitializer" style="height: 550px" />
</p>

<p>This gives you complete control over the startup sequence and lets you configure containers exactly how you need them.</p>

<h3 id="real-world-example-testing-email-with-smtp4dev-or-mailpit">Real-World Example: Testing Email with smtp4dev (or Mailpit)</h3>

<p>My app sends emails, and I needed to test that realistically without spamming real inboxes.</p>

<p><strong>smtp4dev</strong> is a fake SMTP server that catches emails and exposes them via REST API. 
It’s been around for years, has a mature codebase, and includes features like relay testing and authentication simulation. 
Perfect for comprehensive email testing scenarios.</p>

<p><strong>Mailpit</strong> is a modern alternative written in Go, known for its lightweight footprint, faster startup times, and slick UI. 
It also has excellent search capabilities and built-in spam score analysis. 
If you’re starting fresh, Mailpit is often the go-to choice in 2025, but smtp4dev remains solid for existing projects.</p>

<p>Both expose REST APIs for programmatic testing, support SMTP authentication, and provide web UIs for manual inspection. 
The main differences:</p>

<ul>
  <li><strong>Performance</strong>: Mailpit starts faster and uses less memory (~10-20MB vs ~50-100MB)</li>
  <li><strong>UI</strong>: Mailpit has a more modern, responsive interface</li>
  <li><strong>Features</strong>: smtp4dev has more enterprise features (relay, conditional rules); Mailpit focuses on simplicity</li>
  <li><strong>Docker size</strong>: Mailpit image is smaller (~15MB vs ~200MB)</li>
</ul>

<p>For most Spring Boot integration tests, either works great. 
I’ll show you smtp4dev here, but switching to Mailpit is as simple as changing the image name.</p>

<p>Here’s smtp4dev in action:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Smtp4devTestContainerInitializer</span> <span class="kd">implements</span> <span class="nc">ApplicationContextInitializer</span><span class="o">&lt;</span><span class="nc">ConfigurableApplicationContext</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">GenericContainer</span><span class="o">&lt;?&gt;</span> <span class="n">smtp4devContainer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GenericContainer</span><span class="o">&lt;&gt;(</span><span class="nc">DockerImageName</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"rnwood/smtp4dev:3.10.3"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">withExposedPorts</span><span class="o">(</span><span class="mi">80</span><span class="o">,</span> <span class="mi">25</span><span class="o">)</span>
        <span class="o">.</span><span class="na">waitingFor</span><span class="o">(</span><span class="nc">Wait</span><span class="o">.</span><span class="na">forHttp</span><span class="o">(</span><span class="s">"/api/messages"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">forPort</span><span class="o">(</span><span class="mi">80</span><span class="o">)</span>
        <span class="o">.</span><span class="na">forStatusCode</span><span class="o">(</span><span class="mi">200</span><span class="o">));</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="nc">ConfigurableApplicationContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">smtp4devContainer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        
        <span class="nc">TestPropertyValues</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
        <span class="s">"spring.mail.host="</span> <span class="o">+</span> <span class="n">smtp4devContainer</span><span class="o">.</span><span class="na">getHost</span><span class="o">(),</span>
        <span class="s">"spring.mail.port="</span> <span class="o">+</span> <span class="n">smtp4devContainer</span><span class="o">.</span><span class="na">getMappedPort</span><span class="o">(</span><span class="mi">25</span><span class="o">)</span>
        <span class="o">).</span><span class="na">applyTo</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Now in a test:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootTest</span>
<span class="nd">@ContextConfiguration</span><span class="o">(</span><span class="n">initializers</span> <span class="o">=</span> <span class="nc">Smtp4devTestContainerInitializer</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">KrustyKrabEmailServiceTest</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="nc">EmailService</span> <span class="n">emailService</span><span class="o">;</span>
    
    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">givenBikiniBottomCitizen_whenSendingWelcome_thenMessageSends</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">emailService</span><span class="o">.</span><span class="na">sendWelcome</span><span class="o">(</span><span class="s">"patrick.star@bikinibottom.com"</span><span class="o">);</span>
        
        <span class="nc">RestTemplate</span> <span class="n">rest</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">RestTemplate</span><span class="o">();</span>
        <span class="nc">String</span> <span class="n">messagesApi</span> <span class="o">=</span> <span class="s">"http://"</span> <span class="o">+</span>
        <span class="nc">Smtp4devTestContainerInitializer</span><span class="o">.</span><span class="na">smtp4devContainer</span><span class="o">.</span><span class="na">getHost</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span> <span class="o">+</span>
        <span class="nc">Smtp4devTestContainerInitializer</span><span class="o">.</span><span class="na">smtp4devContainer</span><span class="o">.</span><span class="na">getMappedPort</span><span class="o">(</span><span class="mi">80</span><span class="o">)</span> <span class="o">+</span>
        <span class="s">"/api/messages"</span><span class="o">;</span>
        
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;&gt;</span> <span class="n">messages</span> <span class="o">=</span> <span class="n">rest</span><span class="o">.</span><span class="na">getForObject</span><span class="o">(</span><span class="n">messagesApi</span><span class="o">,</span> <span class="nc">List</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        
        <span class="n">assertEquals</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">messages</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">messages</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="s">"subject"</span><span class="o">).</span><span class="na">toString</span><span class="o">()).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="s">"Welcome"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Key things:</p>

<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">withExposedPorts(80, 25)</code></strong> exposes the web UI + SMTP port</li>
  <li><strong><code class="language-plaintext highlighter-rouge">waitingFor(Wait.forHttp(...))</code></strong> waits until the API is really alive</li>
  <li><strong><code class="language-plaintext highlighter-rouge">TestPropertyValues</code></strong> wires the container config into Spring</li>
</ul>

<p>Want to use <strong>Mailpit</strong> instead? Here’s the equivalent initializer:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MailpitTestContainerInitializer</span> <span class="kd">implements</span> <span class="nc">ApplicationContextInitializer</span><span class="o">&lt;</span><span class="nc">ConfigurableApplicationContext</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">GenericContainer</span><span class="o">&lt;?&gt;</span> <span class="n">mailpitContainer</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GenericContainer</span><span class="o">&lt;&gt;(</span><span class="nc">DockerImageName</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="s">"axllent/mailpit:v1.27.8"</span><span class="o">))</span>
        <span class="o">.</span><span class="na">withExposedPorts</span><span class="o">(</span><span class="mi">8025</span><span class="o">,</span> <span class="mi">1025</span><span class="o">)</span>
        <span class="o">.</span><span class="na">waitingFor</span><span class="o">(</span><span class="nc">Wait</span><span class="o">.</span><span class="na">forHttp</span><span class="o">(</span><span class="s">"/api/v1/messages"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">forPort</span><span class="o">(</span><span class="mi">8025</span><span class="o">)</span>
        <span class="o">.</span><span class="na">forStatusCode</span><span class="o">(</span><span class="mi">200</span><span class="o">));</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="nc">ConfigurableApplicationContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mailpitContainer</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        
        <span class="nc">TestPropertyValues</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
        <span class="s">"spring.mail.host="</span> <span class="o">+</span> <span class="n">mailpitContainer</span><span class="o">.</span><span class="na">getHost</span><span class="o">(),</span>
        <span class="s">"spring.mail.port="</span> <span class="o">+</span> <span class="n">mailpitContainer</span><span class="o">.</span><span class="na">getMappedPort</span><span class="o">(</span><span class="mi">1025</span><span class="o">)</span>
        <span class="o">).</span><span class="na">applyTo</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The key differences:</p>
<ul>
  <li>Port 8025 for web UI (vs 80 in smtp4dev)</li>
  <li>Port 1025 for SMTP (vs 25)</li>
  <li>API path is <code class="language-plaintext highlighter-rouge">/api/v1/messages</code> instead of <code class="language-plaintext highlighter-rouge">/api/messages</code></li>
</ul>

<p>Both work identically in your tests. Choose smtp4dev if you need advanced relay features or are already using it. Choose Mailpit if you want faster container startup and a smaller Docker footprint.</p>

<h3 id="postgresql-with-initialization-scripts">PostgreSQL with Initialization Scripts</h3>

<p>Sometimes I don’t want an empty database. I want schema + seed data loaded.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDatabaseInitializer</span> <span class="kd">implements</span> <span class="nc">ApplicationContextInitializer</span><span class="o">&lt;</span><span class="nc">ConfigurableApplicationContext</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;?&gt;</span> <span class="n">postgres</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;&gt;(</span><span class="s">"postgres:16-alpine"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">withDatabaseName</span><span class="o">(</span><span class="s">"myapp"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">withCopyFileToContainer</span><span class="o">(</span><span class="nc">MountableFile</span><span class="o">.</span><span class="na">forClasspathResource</span><span class="o">(</span><span class="s">"init_schema.sql"</span><span class="o">),</span> <span class="s">"/docker-entrypoint-initdb.d/"</span><span class="o">);</span>
    
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="nc">ConfigurableApplicationContext</span> <span class="n">context</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">postgres</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
        
        <span class="nc">TestPropertyValues</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
        <span class="s">"spring.datasource.url="</span> <span class="o">+</span> <span class="n">postgres</span><span class="o">.</span><span class="na">getJdbcUrl</span><span class="o">(),</span>
        <span class="s">"spring.datasource.username="</span> <span class="o">+</span> <span class="n">postgres</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span>
        <span class="s">"spring.datasource.password="</span> <span class="o">+</span> <span class="n">postgres</span><span class="o">.</span><span class="na">getPassword</span><span class="o">()</span>
        <span class="o">).</span><span class="na">applyTo</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The trick: <strong><code class="language-plaintext highlighter-rouge">withCopyFileToContainer</code></strong> → place schema in <code class="language-plaintext highlighter-rouge">/docker-entrypoint-initdb.d/</code>. Postgres runs it automatically on startup.</p>

<h2 id="specialized-containers-vs-genericcontainer">Specialized Containers vs GenericContainer</h2>

<p>You might have noticed I used both <code class="language-plaintext highlighter-rouge">PostgreSQLContainer</code> and <code class="language-plaintext highlighter-rouge">GenericContainer</code>.</p>

<p>Here’s the rule of thumb:</p>

<ul>
  <li><strong>Use specialized containers</strong> when they exist (<code class="language-plaintext highlighter-rouge">PostgreSQLContainer</code>, <code class="language-plaintext highlighter-rouge">MongoDBContainer</code>, <code class="language-plaintext highlighter-rouge">KafkaContainer</code>, …).
They give you nice defaults and shortcuts.</li>
  <li><strong>Use <code class="language-plaintext highlighter-rouge">GenericContainer</code></strong> when no module exists (smtp4dev, Mailpit, custom APIs, your own Docker images).</li>
</ul>

<p>Think of <code class="language-plaintext highlighter-rouge">GenericContainer</code> as the <strong>Swiss Army knife</strong> of Testcontainers.
Everything else is built on top of it.</p>

<h2 id="pro-tips-from-my-experience">Pro Tips from My Experience</h2>
<h4 id="reuse-containers-across-tests"><strong>Reuse containers across tests</strong></h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Container</span>
<span class="kd">static</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;?&gt;</span> <span class="n">postgres</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;&gt;(</span><span class="s">"postgres:16.3"</span><span class="o">);</span>
</code></pre></div></div>

<p>Make them <code class="language-plaintext highlighter-rouge">static</code> to avoid restarting for every method. Here’s why this matters:</p>

<p align="center">
    <img src="/assets/img/static_1.svg" alt="Without static" style="height: 550px; margin-bottom: -400px; margin-top: -200px" />
    <img src="/assets/img/static_2.svg" alt="With static" style="height: 550px; margin-top: -100px; margin-bottom: -200px" />
</p>

<h4 id="pin-image-versions"><strong>Pin image versions</strong></h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">new</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;&gt;(</span><span class="s">"postgres:16-alpine"</span><span class="o">);</span> <span class="c1">// stable</span>
<span class="k">new</span> <span class="nc">PostgreSQLContainer</span><span class="o">&lt;&gt;(</span><span class="s">"postgres:latest"</span><span class="o">);</span> <span class="c1">// risky</span>
</code></pre></div></div>

<h4 id="share-initializers-across-test-classes"><strong>Share initializers</strong> across test classes</h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@SpringBootTest</span>
<span class="nd">@ContextConfiguration</span><span class="o">(</span><span class="n">initializers</span> <span class="o">=</span> <span class="o">{</span>
<span class="nc">TestDatabaseInitializer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
<span class="nc">Smtp4devTestContainerInitializer</span><span class="o">.</span><span class="na">class</span>
<span class="o">})</span>
<span class="kd">class</span> <span class="nc">MyIntegrationTest</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
</code></pre></div></div>

<h4 id="dont-worry-too-much-about-test-speed"><strong>Don’t worry too much about test speed</strong></h4>
<p>Yes, Docker containers take a few seconds to start. 
But with static containers and proper reuse, I’ve found the startup cost is negligible compared to the confidence I gain. 
My test suite with PostgreSQL and smtp4dev adds maybe 5-10 seconds total. Well worth it.</p>

<h4 id="check-logs-when-debugging"><strong>Check logs when debugging</strong></h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">postgres</span><span class="o">.</span><span class="na">getLogs</span><span class="o">());</span>
</code></pre></div></div>

<h2 id="wrapping-up">Wrapping Up</h2>
<p>Testcontainers transformed how I think about integration testing.</p>

<p>I started with <code class="language-plaintext highlighter-rouge">@Container</code> and <code class="language-plaintext highlighter-rouge">@DynamicPropertySource</code> for simple cases.
When I needed more control, I reached for <code class="language-plaintext highlighter-rouge">ApplicationContextInitializer</code>.
And when I had to test against any Docker image, <code class="language-plaintext highlighter-rouge">GenericContainer</code> had my back.</p>

<p>The beauty is that I’m always testing against <strong>the real thing</strong>.
Real databases, real SMTP servers, real APIs and this without any of the traditional headaches of managing those services locally.</p>

<p>If you’re not using Testcontainers yet, I encourage you to give it a try on your next Spring Boot project.
Your future self (and your teammates) will thank you.</p>

<p>Now go forth and containerize those tests</p>

<h2 id="resources">Resources</h2>
<p><strong>Official Documentation:</strong></p>
<ul>
  <li><a href="https://www.testcontainers.org/">Testcontainers Official Documentation</a></li>
  <li><a href="https://java.testcontainers.org/">Testcontainers for Java</a></li>
  <li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.testing">Spring Boot Testing Documentation</a></li>
</ul>

<p><strong>Docker Images Used:</strong></p>
<ul>
  <li><a href="https://hub.docker.com/_/postgres">PostgreSQL on Docker Hub</a></li>
  <li><a href="https://github.com/rnwood/smtp4dev">smtp4dev on GitHub</a></li>
  <li><a href="https://github.com/axllent/mailpit">Mailpit on GitHub</a></li>
</ul>

<p><strong>Related Tools:</strong></p>
<ul>
  <li><a href="https://www.docker.com/products/docker-desktop/">Docker Desktop</a></li>
  <li><a href="https://mvnrepository.com/artifact/org.testcontainers">Maven Central - Testcontainers</a></li>
</ul>]]></content><author><name>Oumaima Zerouali</name><email>oumaima.zerouali@gmail.com</email></author><category term="java" /><category term="spring-boot" /><category term="testing" /><category term="docker" /><summary type="html"><![CDATA[“Testcontainers is like having SpongeBob at the helm of your CI: cheerful, reliable, and somehow turning chaos into perfection.” - Me]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/img/spongebob-testcontainers.png" /><media:content medium="image" url="http://localhost:4000/assets/img/spongebob-testcontainers.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="en"><title type="html">Exceptions: The Emergency Brake, Not the Steering Wheel</title><link href="http://localhost:4000/2025/08/05/exceptions-should-be-exceptional/" rel="alternate" type="text/html" title="Exceptions: The Emergency Brake, Not the Steering Wheel" /><published>2025-08-05T09:00:00+02:00</published><updated>2025-08-05T09:00:00+02:00</updated><id>http://localhost:4000/2025/08/05/exceptions-should-be-exceptional</id><content type="html" xml:base="http://localhost:4000/2025/08/05/exceptions-should-be-exceptional/"><![CDATA[<blockquote>
  <p>“You don’t need a license to drive a sandwich.” — SpongeBob SquarePants</p>
</blockquote>

<p>As developers, we’re told to handle errors.<br />
But how we handle them really affects the way our code works.</p>

<p>A common mistake, especially in Java, is using exceptions to manage normal, expected stuff.<br />
It’s like using your car’s emergency brake every time you hit a red light.<br />
It kinda works… until it doesn’t.</p>

<p>Eventually, your code slows down, gets messy, and people avoid touching it like it’s cursed.</p>

<p>And hey, I’ve done it too.<br />
Throwing an exception is easy.<br />
It feels like a clean escape hatch when logic gets too messy.<br />
But here’s the thing: exceptions are meant for <strong>unexpected problems</strong>, not everyday flow.</p>

<p>Martin Fowler put it best:</p>
<blockquote>
  <p><strong>Exceptions should be exceptional.</strong></p>
</blockquote>

<p>Let’s break that down.</p>

<h2 id="what-actually-counts-as-exceptional">What <em>Actually</em> Counts as “Exceptional”?</h2>

<p>Think of an exception like a fire alarm.<br />
It should only go off when something’s seriously wrong. 
Something the code couldn’t have planned for.</p>

<p>Here’s a quick gut check:</p>
<ul>
  <li>Is this a <em>normal</em> part of business logic? → Don’t throw.</li>
  <li>Is this a <em>weird</em> failure that makes the method impossible to finish? → Exception time.</li>
</ul>

<h3 id="examples">Examples:</h3>
<p><strong>Actually Exceptional</strong></p>
<ul>
  <li>DB is down.</li>
  <li>Config file is missing or unreadable.</li>
  <li>API suddenly returns a 500.</li>
</ul>

<p><strong>Not Exceptional</strong></p>
<ul>
  <li>No user found for a search.</li>
  <li>Email format is invalid.</li>
  <li>List is empty.</li>
</ul>

<p>If it’s something you <em>expect might happen</em>, just handle it with normal logic.</p>

<h2 id="when-throwing-is-the-right-call">When Throwing Is the Right Call</h2>

<p>Here’s a good example of when an exception makes sense.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">squareRoot</span><span class="o">(</span><span class="kt">double</span> <span class="n">number</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">number</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Cannot calculate the square root of a negative number."</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="nc">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">number</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This method’s job is to calculate square roots. If you give it a negative number, it literally can’t do that.
So yeah, an exception is fair. That’s not just “bad input”, it breaks the rules of what the method can even do.</p>

<h2 id="what-to-do-when-failures-arent-exceptional">What to Do When Failures <em>Aren’t</em> Exceptional</h2>

<p>Let’s talk about validation.</p>

<p>Imagine a user signs up with a bad email <em>and</em> a weak password.
Do you want to throw an exception for each issue, stopping after the first one?
Or do you want to show all the problems at once?</p>

<h3 id="the-wrong-way">The Wrong Way</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">(!</span><span class="n">email</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"@"</span><span class="o">))</span> <span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">InvalidUserException</span><span class="o">(</span><span class="s">"Email is invalid."</span><span class="o">);</span>
<span class="o">}</span>
<span class="k">if</span> <span class="o">(</span><span class="n">password</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">InvalidUserException</span><span class="o">(</span><span class="s">"Password too short."</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This stops after the email fails, so the user keeps fixing one thing at a time. 
Super annoying.</p>

<h3 id="a-better-way-notification-pattern">A Better Way: Notification Pattern</h3>

<p>Let’s collect all issues in one go:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Notification</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">errors</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addError</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span> <span class="n">errors</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">message</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasErrors</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="o">!</span><span class="n">errors</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getErrors</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">errors</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="nc">Notification</span> <span class="nf">validate</span><span class="o">(</span><span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Notification</span> <span class="n">notification</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Notification</span><span class="o">();</span>

    <span class="k">if</span> <span class="o">(!</span><span class="n">user</span><span class="o">.</span><span class="na">getEmail</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="s">"@"</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">notification</span><span class="o">.</span><span class="na">addError</span><span class="o">(</span><span class="s">"Email is invalid."</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getPassword</span><span class="o">().</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">notification</span><span class="o">.</span><span class="na">addError</span><span class="o">(</span><span class="s">"Password must be at least 8 characters."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">notification</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Now the user gets <em>all</em> feedback at once.
The backend stays chill.
No emergency brakes needed.</p>

<h2 id="custom-exceptions-when-theyre-actually-helpful">Custom Exceptions: When They’re Actually Helpful</h2>

<p>Custom exceptions are fine when they <em>mean</em> something specific, especially in business logic.</p>

<p>Example: a banking app.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">InsufficientFundsException</span> <span class="kd">extends</span> <span class="nc">RuntimeException</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">InsufficientFundsException</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This makes it super clear what went wrong and you can handle it differently than, say, a network error.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
    <span class="n">accountService</span><span class="o">.</span><span class="na">withdraw</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InsufficientFundsException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">showError</span><span class="o">(</span><span class="s">"You don’t have enough funds."</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">NetworkException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">showError</span><span class="o">(</span><span class="s">"Connection error. Please try again."</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The goal: make errors <em>understandable</em> and <em>actionable</em>.</p>

<h2 id="the-hidden-costs-of-misusing-exceptions">The Hidden Costs of Misusing Exceptions</h2>

<p><strong>1. Performance</strong>
Throwing an exception isn’t free.
The JVM captures the whole stack trace, and that takes time.
If you’re throwing exceptions in a tight loop or in a high-traffic app, you’re asking for trouble.</p>

<p><strong>2. Readability</strong>
<code class="language-plaintext highlighter-rouge">try-catch</code> blocks are loud.
If you use them for stuff that’s not an error, your code becomes harder to read and understand.
Future you, or someone else, has to stop and ask, “Wait, is this <em>really</em> an error?”</p>

<p><strong>3. Bad APIs</strong>
If your backend throws an exception for bad input, it might just send back a generic <code class="language-plaintext highlighter-rouge">500</code>.
But that’s not a server error, it’s a user mistake.
Instead, return a <code class="language-plaintext highlighter-rouge">400 Bad Request</code> with a clean JSON response explaining what’s wrong.</p>

<h2 id="the-bigger-picture-dont-be-clever-be-clear">The Bigger Picture: Don’t Be “Clever”, Be Clear</h2>

<p>Throwing exceptions for normal stuff feels clever at first.
But clever code ages badly.</p>

<p>Clean code is clear code.
It doesn’t use exceptions like fancy <code class="language-plaintext highlighter-rouge">if</code> statements.
It uses them when something genuinely breaks.</p>]]></content><author><name>Oumaima Zerouali</name><email>oumaima.zerouali@gmail.com</email></author><category term="java" /><category term="best-practices" /><category term="architecture" /><summary type="html"><![CDATA[“You don’t need a license to drive a sandwich.” — SpongeBob SquarePants]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/img/exceptions.png" /><media:content medium="image" url="http://localhost:4000/assets/img/exceptions.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="nl"><title type="html">Exceptions: De Noodrem, niet de stuurwiel</title><link href="http://localhost:4000/nl/2025/08/05/exceptions-should-be-exceptional/" rel="alternate" type="text/html" title="Exceptions: De Noodrem, niet de stuurwiel" /><published>2025-08-05T09:00:00+02:00</published><updated>2025-08-05T09:00:00+02:00</updated><id>http://localhost:4000/nl/2025/08/05/exceptions-should-be-exceptional</id><content type="html" xml:base="http://localhost:4000/nl/2025/08/05/exceptions-should-be-exceptional/"><![CDATA[<blockquote>
  <p>“You don’t need a license to drive a sandwich.” — SpongeBob SquarePants</p>
</blockquote>

<p>Als developers wordt ons verteld dat we fouten moeten afhandelen.<br />
Maar hoe we dat doen beïnvloedt echt hoe onze code werkt.</p>

<p>Een veelgemaakte fout, vooral in Java, is het gebruik van exceptions om normale, verwachte dingen te beheren.<br />
Het is alsof je elke keer de noodrem van je auto gebruikt bij een rood licht.<br />
Het werkt een beetje… totdat het dat niet doet.</p>

<p>Uiteindelijk vertraagt je code, wordt het een rommeltje, en ontwijken mensen het alsof het vervloekt is.</p>

<p>En ja, ik heb het ook gedaan.<br />
Een exception gooien is makkelijk.<br />
Het voelt als een nette uitweg wanneer logica te ingewikkeld wordt.<br />
Maar hier is het punt: exceptions zijn bedoeld voor <strong>onverwachte problemen</strong>, niet voor de dagelijkse flow.</p>

<p>Martin Fowler zei het het beste:</p>
<blockquote>
  <p><strong>Exceptions moeten uitzonderlijk zijn.</strong></p>
</blockquote>

<p>Laten we dat even uit elkaar halen.</p>

<h2 id="wat-telt-echt-als-uitzonderlijk">Wat Telt <em>Echt</em> als “Uitzonderlijk”?</h2>

<p>Denk aan een exception als een brandalarm.<br />
Het mag alleen afgaan wanneer er echt iets mis is.<br />
Iets waar de code niet op had kunnen plannen.</p>

<p>Een snelle check:</p>
<ul>
  <li>Is dit een <em>normaal</em> onderdeel van de businesslogica? → Niet gooien.</li>
  <li>Is dit een <em>vreemde</em> fout waardoor de methode onmogelijk afgemaakt kan worden? → Tijd voor een exception.</li>
</ul>

<h3 id="voorbeelden">Voorbeelden</h3>
<p><strong>Echt Uitzonderlijk</strong></p>
<ul>
  <li>De database ligt eruit.</li>
  <li>Configuratiebestand ontbreekt of is niet leesbaar.</li>
  <li>API geeft ineens een 500 terug.</li>
</ul>

<p><strong>Niet Uitzonderlijk</strong></p>
<ul>
  <li>Geen gebruiker gevonden bij een zoekopdracht.</li>
  <li>Ongeldig e-mailadres.</li>
  <li>Lijst is leeg.</li>
</ul>

<p>Als het iets is dat je <em>zou verwachten</em>, handel het gewoon af met normale logica.</p>

<h2 id="wanneer-een-exception-wél-sinnig-is">Wanneer Een Exception Wél Sinnig Is</h2>

<p>Hier is een goed voorbeeld van wanneer een exception logisch is.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">double</span> <span class="nf">wortel</span><span class="o">(</span><span class="kt">double</span> <span class="n">getal</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">getal</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Kan de wortel van een negatief getal niet berekenen."</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="nc">Math</span><span class="o">.</span><span class="na">sqrt</span><span class="o">(</span><span class="n">getal</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Deze methode moet wortels berekenen. Als je er een negatief getal in stopt, kan hij dat letterlijk niet doen.
Dus ja, een exception is terecht. Dit is niet zomaar “foute input”, het breekt de regels van wat de methode überhaupt kan doen.</p>

<h2 id="wat-te-doen-wanneer-fouten-niet-uitzonderlijk-zijn">Wat Te Doen Wanneer Fouten <em>Niet</em> Uitzonderlijk Zijn</h2>

<p>Laten we het hebben over validatie.</p>

<p>Stel, een gebruiker registreert zich met een slecht e-mailadres <em>en</em> een zwak wachtwoord.
Wil je voor elk probleem een exception gooien en stoppen na het eerste?
Of wil je alle problemen tegelijk tonen?</p>

<h3 id="de-verkeerde-manier">De Verkeerde Manier</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="o">(!</span><span class="n">email</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"@"</span><span class="o">))</span> <span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">InvalidUserException</span><span class="o">(</span><span class="s">"E-mail is ongeldig."</span><span class="o">);</span>
<span class="o">}</span>
<span class="k">if</span> <span class="o">(</span><span class="n">password</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">InvalidUserException</span><span class="o">(</span><span class="s">"Wachtwoord te kort."</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Dit stopt na de eerste fout, dus de gebruiker moet één probleem tegelijk oplossen.
Super irritant.</p>

<h3 id="een-betere-manier-notification-pattern">Een Betere Manier: Notification Pattern</h3>

<p>Verzamel alle problemen tegelijk:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Notificatie</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">fouten</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">voegFoutToe</span><span class="o">(</span><span class="nc">String</span> <span class="n">bericht</span><span class="o">)</span> <span class="o">{</span> <span class="n">fouten</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">bericht</span><span class="o">);</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">heeftFouten</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="o">!</span><span class="n">fouten</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">();</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">getFouten</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">fouten</span><span class="o">;</span> <span class="o">}</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="nc">Notificatie</span> <span class="nf">valideer</span><span class="o">(</span><span class="nc">Gebruiker</span> <span class="n">gebruiker</span><span class="o">)</span> <span class="o">{</span>
    <span class="nc">Notificatie</span> <span class="n">notificatie</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Notificatie</span><span class="o">();</span>

    <span class="k">if</span> <span class="o">(!</span><span class="n">gebruiker</span><span class="o">.</span><span class="na">getEmail</span><span class="o">().</span><span class="na">contains</span><span class="o">(</span><span class="s">"@"</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">notificatie</span><span class="o">.</span><span class="na">voegFoutToe</span><span class="o">(</span><span class="s">"E-mail is ongeldig."</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">gebruiker</span><span class="o">.</span><span class="na">getPassword</span><span class="o">().</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">notificatie</span><span class="o">.</span><span class="na">voegFoutToe</span><span class="o">(</span><span class="s">"Wachtwoord moet minstens 8 tekens bevatten."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="n">notificatie</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Nu krijgt de gebruiker <em>alle</em> feedback tegelijk.
De backend blijft rustig.
Geen noodrem nodig.</p>

<h2 id="custom-exceptions-wanneer-ze-wél-handig-zijn">Custom Exceptions: Wanneer Ze Wél Handig Zijn</h2>

<p>Custom exceptions zijn prima wanneer ze iets <em>specifieks</em> betekenen, vooral in businesslogica.</p>

<p>Voorbeeld: een bankapplicatie.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">OnvoldoendeSaldoException</span> <span class="kd">extends</span> <span class="nc">RuntimeException</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="nf">OnvoldoendeSaldoException</span><span class="o">(</span><span class="nc">String</span> <span class="n">message</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Dit maakt meteen duidelijk wat er misging, en je kunt dit anders afhandelen dan bijvoorbeeld een netwerkfout.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
    <span class="n">rekeningService</span><span class="o">.</span><span class="na">opnemen</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">OnvoldoendeSaldoException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">toonFout</span><span class="o">(</span><span class="s">"Je hebt niet genoeg saldo."</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">NetworkException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">toonFout</span><span class="o">(</span><span class="s">"Verbindingsfout. Probeer opnieuw."</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Doel: fouten <em>begrijpelijk</em> en <em>handelbaar</em> maken.</p>

<h2 id="de-verborgen-kosten-van-misbruik-van-exceptions">De Verborgen Kosten van Misbruik van Exceptions</h2>

<p><strong>1. Performance</strong>
Exceptions gooien is niet gratis.
De JVM legt de volledige stacktrace vast, en dat kost tijd.
Als je dit in een strakke loop of in een drukke app doet, vraag je om problemen.</p>

<p><strong>2. Leesbaarheid</strong>
<code class="language-plaintext highlighter-rouge">try-catch</code> blokken zijn luid.
Gebruik je ze voor dingen die geen fout zijn, dan wordt je code moeilijker te lezen.
Toekomstig jij, of een collega, moet stoppen en denken: “Is dit <em>echt</em> een fout?”</p>

<p><strong>3. Slechte API’s</strong>
Gooi je een exception voor foute input in de backend, dan stuurt hij misschien gewoon een generieke <code class="language-plaintext highlighter-rouge">500</code>.
Maar dat is geen serverfout, het is een gebruikersfout.
Stuur liever een <code class="language-plaintext highlighter-rouge">400 Bad Request</code> met een nette JSON die uitlegt wat er mis is.</p>

<h2 id="het-grote-geheel-wees-duidelijk-niet-slim">Het Grote Geheel: Wees Duidelijk, Niet “Slim”</h2>

<p>Exceptions gooien voor normale dingen voelt eerst slim.
Maar slimme code veroudert slecht.</p>

<p>Schone code is duidelijke code.
Het gebruikt exceptions niet als fancy <code class="language-plaintext highlighter-rouge">if</code> statements.
Het gebruikt ze alleen wanneer iets echt stuk gaat.</p>]]></content><author><name>Oumaima Zerouali</name><email>oumaima.zerouali@gmail.com</email></author><category term="java" /><category term="best-practices" /><category term="architecture" /><summary type="html"><![CDATA[“You don’t need a license to drive a sandwich.” — SpongeBob SquarePants]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/img/exceptions.png" /><media:content medium="image" url="http://localhost:4000/assets/img/exceptions.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry xml:lang="nl"><title type="html">Error 404: Motivatie Niet Gevonden. Wanneer Je Codebase Je Laat Laten Staan</title><link href="http://localhost:4000/nl/2025/08/01/error-404-motiviation-not-found/" rel="alternate" type="text/html" title="Error 404: Motivatie Niet Gevonden. Wanneer Je Codebase Je Laat Laten Staan" /><published>2025-08-01T13:00:00+02:00</published><updated>2025-08-01T13:00:00+02:00</updated><id>http://localhost:4000/nl/2025/08/01/error-404-motiviation-not-found</id><content type="html" xml:base="http://localhost:4000/nl/2025/08/01/error-404-motiviation-not-found/"><![CDATA[<blockquote>
  <p>“I’ll have you know that I stubbed my toe last week and only cried for 20 minutes.” - Spongebob SquarePants</p>
</blockquote>

<p>We hebben het allemaal wel eens meegemaakt: van die dagen dat je vol energie zit en een nieuw project induikt.<br />
De code stroomt, de tests slagen, en je voelt je de meester van de digitale wereld.<br />
Maar dan gebeurt het: je opent je editor en… niets.<br />
De inspiratie is weg.<br />
<strong>Error 404: Motivatie Niet Gevonden.</strong></p>

<p>Dit is niet zomaar uitstelgedrag.<br />
Het project dat ooit zo veelbelovend leek, voelt nu als een ondoorgrondelijk, onbekend terrein.<br />
Je weet dat je iets moet doen, maar je hebt geen idee waar te beginnen.</p>

<h3 id="de-vreemdeling-in-je-eigen-code">De Vreemdeling in Je Eigen Code</h3>
<p>Een van de meest voorkomende redenen voor dit gevoel is dat je codebase voelt alsof hij van iemand anders is.<br />
Zelfs als je het zelf hebt geschreven, kan een project van een paar maanden geleden ineens een vreemde aanvoelen.</p>

<ul>
  <li><strong>Onleesbare code:</strong> Geen duidelijke variabelen, geen documentatie. Wat deed die functie ook alweer? Waarom schreef ik het zo?</li>
  <li><strong>Onbegrijpelijke architectuur:</strong> De structuur van het project is zo complex dat je de logica niet meer kunt volgen.</li>
  <li><strong>Gebroken tests:</strong> Of nog erger, helemaal geen tests. De angst iets te wijzigen en het hele project te breken verhindert je om überhaupt iets te doen.</li>
</ul>

<p>Dit zijn de momenten dat je beseft dat je hebt geïnvesteerd in een lastpost: <strong>technische schuld</strong>.<br />
Het is alsof je jaren hebt uitgesteld om af te wassen, en nu sta je voor een berg vuile borden zo hoog dat je de motivatie verliest om te beginnen.</p>

<h3 id="de-eindeloze-refactor-lus">De Eindeloze Refactor-lus</h3>
<p>Naast technische schuld is er nog een grote motivatie-killer: de constante behoefte om te veranderen.<br />
De ene dag heb je een geweldig idee voor het design, een nieuw kleurenschema, of een andere aanpak van de architectuur.<br />
Een paar dagen later verander je van gedachten en besluit je alles te refactoren.<br />
Deze eindeloze lus van “nu maak ik het perfect” is een valstrik.<br />
Je houdt nooit lang genoeg vast aan één idee om het af te maken, en je eindigt met een gefragmenteerd, half-af project en nul motivatie.</p>

<h3 id="hoe-herverbinden">Hoe Herverbinden</h3>
<p>Het herstellen van de relatie met je codebase vereist een paar strategische stappen.<br />
Het is geen snelle oplossing, maar een investering in de toekomst.</p>

<ol>
  <li><strong>Begin klein. Heel klein.</strong> Probeer niet het hele project te herschrijven. Zoek een kleine, geïsoleerde taak. Een bug fix in één functie, of een paar regels code refactoren om ze beter leesbaar te maken. Maak kleine commits met duidelijke berichten zodat je er makkelijk naar terug kunt verwijzen.</li>
  <li><strong>Maak één idee af voordat je aan een ander begint.</strong> In plaats van constant te refactoren, commit je aan één idee voor je design of architectuur. Werk eraan, maak het af, en <strong>deploy iets</strong>. Zodra het live staat, kun je beter beslissen wat er veranderd moet worden.</li>
  <li><strong>Schrijf tests.</strong> Niets geeft meer vertrouwen dan goede tests. Voeg een eenvoudige unit test toe aan de code die je aanraakt. Dit geeft je een vangnet en het vertrouwen om verdere wijzigingen door te voeren.</li>
  <li><strong>Documenteer je eigen code.</strong> Zodra je een klein onderdeel hebt begrepen, schrijf het op. Voeg commentaar toe, update de README. Dit helpt niet alleen jezelf in de toekomst, maar ook iedereen die later met deze code werkt.</li>
  <li><strong>Praat erover.</strong> Bespreek het project met een collega of in een community. Soms is een frisse blik alles wat je nodig hebt. Leg uit waar je vastloopt. Het proces van je probleem verwoorden kan vaak tot de oplossing leiden.</li>
  <li><strong>Gun jezelf een pauze.</strong> Soms is de beste aanpak om er helemaal afstand van te nemen. Ga wandelen, lees een boek, of werk aan een ander project. De oplossing komt vaak op de meest onverwachte momenten, wanneer je geest niet actief aan het worstelen is.</li>
</ol>]]></content><author><name>Oumaima Zerouali</name><email>oumaima.zerouali@gmail.com</email></author><category term="personal" /><category term="career" /><category term="productivity" /><summary type="html"><![CDATA[“I’ll have you know that I stubbed my toe last week and only cried for 20 minutes.” - Spongebob SquarePants]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/assets/img/error-motivation-not-found.png" /><media:content medium="image" url="http://localhost:4000/assets/img/error-motivation-not-found.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>