---
layout: default
---


{% assign current_lang = page.lang | default: site.default_lang %}

<section class="posts-page">
    <header class="posts-header">
        <h1>{{ site.data.translations[current_lang].posts.title }}</h1>
        <p class="posts-subtitle">{{ site.data.translations[current_lang].posts.subtitle }}</p>
    </header>

    <div class="tag-filter-wrapper">
        <label for="tag-select" class="sr-only">Filter posts by tag</label>
        <select id="tag-select" class="tag-filter-select" aria-label="Filter posts by tag">
            <option value="all">{{ site.data.translations[current_lang].posts.filter_all }}</option>
            {% assign all_tags = "" | split: "" %}

            {% for post in site.posts %}
                {% if post.lang == current_lang and post.tags %}
                    {% for tag in post.tags %}
                        {% unless all_tags contains tag %}
                            {% assign all_tags = all_tags | push: tag %}
                        {% endunless %}
                    {% endfor %}
                {% endif %}
            {% endfor %}

            {% assign sorted_tags = all_tags | sort %}
            {% for tag in sorted_tags %}
            <option value="{{ tag }}">{{ tag }}</option>
            {% endfor %}
        </select>
    </div>

    <section class="posts-grid">
        {% assign post_index = 0 %}
        {% for post in site.posts %}
            {% if post.lang == current_lang %}
            {% assign post_index = post_index | plus: 1 %}
            <article class="post-card{% if post_index | modulo: 7 == 0 or post_index | modulo: 5 == 0 %} post-card--large{% endif %}" data-tags="{% if post.tags %}{% for tag in post.tags %}{{ tag }}{% unless forloop.last %},{% endunless %}{% endfor %}{% endif %}">
                <h2 class="post-card-title">
                    <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
                </h2>
                {% if post.excerpt %}
                <p class="post-card-excerpt">{{ post.excerpt | strip_html | truncatewords: 25 }}</p>
                {% endif %}
                <div class="post-card-meta">
                    <time datetime="{{ post.date | date_to_xmlschema }}">{{ post.date | date: "%B %d, %Y" }}</time>
                    {% if post.tags %}
                    <div class="post-card-tags">
                        {% for tag in post.tags limit:3 %}
                        <span class="tag">{{ tag }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
            </article>
            {% endif %}
        {% endfor %}
    </section>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tagSelect = document.getElementById('tag-select');
    const postCards = document.querySelectorAll('.post-card');
    const liveAnnouncer = document.getElementById('live-announcer');

    tagSelect.addEventListener('change', function() {
        const selectedTag = this.value;
        let visibleCount = 0;

        postCards.forEach(card => {
            const cardTags = card.getAttribute('data-tags');

            if (selectedTag === 'all') {
                card.style.display = 'flex';
                setTimeout(() => card.style.opacity = '1', 10);
                visibleCount++;
            } else if (cardTags && cardTags.split(',').includes(selectedTag)) {
                card.style.display = 'flex';
                setTimeout(() => card.style.opacity = '1', 10);
                visibleCount++;
            } else {
                card.style.opacity = '0';
                setTimeout(() => card.style.display = 'none', 200);
            }
        });

        if (liveAnnouncer) {
            const message = selectedTag === 'all'
                ? `Showing all ${visibleCount} posts`
                : `Filtered to ${visibleCount} post${visibleCount !== 1 ? 's' : ''} with tag ${selectedTag}`;
            liveAnnouncer.textContent = message;
        }
    });
});
</script>
