---
layout: default
---


{% assign current_lang = page.lang | default: site.default_lang %}

<section class="posts-page">
    <header class="posts-header">
        <h1>{{ site.data.translations[current_lang].posts.title }}</h1>
        <p class="posts-subtitle">{{ site.data.translations[current_lang].posts.subtitle }}</p>
    </header>

    <div class="tag-filter-wrapper">
        <label for="tag-select" class="sr-only">Filter posts by tag</label>
        <select id="tag-select" class="tag-filter-select" aria-label="Filter posts by tag">
            <option value="all">{{ site.data.translations[current_lang].posts.filter_all }}</option>
            {% assign all_tags = "" | split: "" %}

            {% for post in site.posts %}
                {% if post.lang == current_lang and post.tags %}
                    {% for tag in post.tags %}
                        {% unless all_tags contains tag %}
                            {% assign all_tags = all_tags | push: tag %}
                        {% endunless %}
                    {% endfor %}
                {% endif %}
            {% endfor %}

            {% assign sorted_tags = all_tags | sort %}
            {% for tag in sorted_tags %}
            <option value="{{ tag }}">{{ tag }}</option>
            {% endfor %}
        </select>
    </div>

    <section class="posts-grid posts-grid--magazine">
        {% comment %} First, count total posts in current language {% endcomment %}
        {% assign total_posts = 0 %}
        {% for post in site.posts %}
            {% if post.lang == current_lang %}
                {% assign total_posts = total_posts | plus: 1 %}
            {% endif %}
        {% endfor %}

        {% assign post_index = 0 %}
        {% for post in site.posts %}
            {% if post.lang == current_lang %}
            {% assign post_index = post_index | plus: 1 %}
            {% assign posts_remaining = total_posts | minus: post_index %}
            {% assign pattern_pos = post_index | modulo: 7 %}

            {% comment %} Don't apply spanning variants to last 3 posts to avoid awkward endings {% endcomment %}
            {% if posts_remaining <= 2 %}
                {% assign card_variant = "" %}
            {% elsif pattern_pos == 1 %}
                {% assign card_variant = "post-card--wide" %}
            {% elsif pattern_pos == 3 %}
                {% assign card_variant = "post-card--tall" %}
            {% elsif pattern_pos == 5 %}
                {% assign card_variant = "post-card--featured-grid" %}
            {% else %}
                {% assign card_variant = "" %}
            {% endif %}
            <article class="post-card {{ card_variant }}" data-tags="{% if post.tags %}{% for tag in post.tags %}{{ tag }}{% unless forloop.last %},{% endunless %}{% endfor %}{% endif %}">
                {% if post.image and card_variant == "post-card--featured-grid" %}
                <div class="post-card-image">
                    <img src="{{ post.image | relative_url }}" alt="{{ post.image_alt | default: 'Featured image for ' | append: post.title }}" loading="lazy" decoding="async">
                </div>
                {% endif %}
                <div class="post-card-content-wrapper">
                    <h2 class="post-card-title">
                        <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
                    </h2>
                    {% if card_variant == "post-card--featured-grid" %}
                        {% if post.excerpt %}
                        <p class="post-card-quote">{{ post.excerpt | strip_html | truncatewords: 25 }}</p>
                        {% endif %}
                        {% assign featured_content = post.content | strip_html | remove_first: post.excerpt %}
                        {% if featured_content %}
                        <p class="post-card-excerpt">{{ featured_content | strip | truncatewords: 40 }}</p>
                        {% endif %}
                    {% else %}
                        {% if post.excerpt %}
                        <p class="post-card-excerpt">{{ post.excerpt | strip_html | truncatewords: 25 }}</p>
                        {% endif %}
                    {% endif %}
                    <div class="post-card-meta">
                        <time datetime="{{ post.date | date_to_xmlschema }}">{{ post.date | date: "%B %d, %Y" }}</time>
                        {% if post.tags %}
                        <div class="post-card-tags">
                            {% for tag in post.tags limit:3 %}
                            <span class="tag">{{ tag }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </article>
            {% endif %}
        {% endfor %}
    </section>
</section>

<script src="{{ '/assets/js/post-filter.js' | relative_url }}"></script>
